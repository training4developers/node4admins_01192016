<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8" />
      <title>NodeJsAdmin_Day2</title>
      <style>.markdown-preview:not([data-use-github-style]) { padding: 2em; font-size: 1.2em; color: rgb(85, 85, 85); overflow: auto; background-color: rgb(255, 255, 255); }
.markdown-preview:not([data-use-github-style]) > :first-child { margin-top: 0px; }
.markdown-preview:not([data-use-github-style]) h1, .markdown-preview:not([data-use-github-style]) h2, .markdown-preview:not([data-use-github-style]) h3, .markdown-preview:not([data-use-github-style]) h4, .markdown-preview:not([data-use-github-style]) h5, .markdown-preview:not([data-use-github-style]) h6 { line-height: 1.2; margin-top: 1.5em; margin-bottom: 0.5em; color: rgb(3, 3, 3); }
.markdown-preview:not([data-use-github-style]) h1 { font-size: 2.4em; font-weight: 300; }
.markdown-preview:not([data-use-github-style]) h2 { font-size: 1.8em; font-weight: 400; }
.markdown-preview:not([data-use-github-style]) h3 { font-size: 1.5em; font-weight: 500; }
.markdown-preview:not([data-use-github-style]) h4 { font-size: 1.2em; font-weight: 600; }
.markdown-preview:not([data-use-github-style]) h5 { font-size: 1.1em; font-weight: 600; }
.markdown-preview:not([data-use-github-style]) h6 { font-size: 1em; font-weight: 600; }
.markdown-preview:not([data-use-github-style]) strong { color: rgb(3, 3, 3); }
.markdown-preview:not([data-use-github-style]) del { color: rgb(126, 126, 126); }
.markdown-preview:not([data-use-github-style]) a, .markdown-preview:not([data-use-github-style]) a code { color: rgb(0, 0, 0); }
.markdown-preview:not([data-use-github-style]) img { max-width: 100%; }
.markdown-preview:not([data-use-github-style]) > p { margin-top: 0px; margin-bottom: 1.5em; }
.markdown-preview:not([data-use-github-style]) > ul, .markdown-preview:not([data-use-github-style]) > ol { margin-bottom: 1.5em; }
.markdown-preview:not([data-use-github-style]) blockquote { margin: 1.5em 0px; font-size: inherit; color: rgb(126, 126, 126); border-color: rgb(214, 214, 214); border-width: 4px; }
.markdown-preview:not([data-use-github-style]) hr { margin: 3em 0px; border-top-width: 2px; border-top-style: dashed; border-top-color: rgb(214, 214, 214); background: none; }
.markdown-preview:not([data-use-github-style]) table { margin: 1.5em 0px; }
.markdown-preview:not([data-use-github-style]) th { color: rgb(3, 3, 3); }
.markdown-preview:not([data-use-github-style]) th, .markdown-preview:not([data-use-github-style]) td { padding: 0.66em 1em; border: 1px solid rgb(214, 214, 214); }
.markdown-preview:not([data-use-github-style]) code { color: rgb(3, 3, 3); background-color: rgb(240, 240, 240); }
.markdown-preview:not([data-use-github-style]) pre.editor-colors { margin: 1.5em 0px; padding: 1em; font-size: 0.92em; border-radius: 3px; background-color: rgb(245, 245, 245); }
.markdown-preview:not([data-use-github-style]) kbd { color: rgb(3, 3, 3); border-width: 1px 1px 2px; border-style: solid; border-color: rgb(214, 214, 214) rgb(214, 214, 214) rgb(199, 199, 199); background-color: rgb(240, 240, 240); }
.markdown-preview[data-use-github-style] { font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 1.6; word-wrap: break-word; padding: 30px; font-size: 16px; color: rgb(51, 51, 51); overflow: scroll; background-color: rgb(255, 255, 255); }
.markdown-preview[data-use-github-style] > :first-child { margin-top: 0px !important; }
.markdown-preview[data-use-github-style] > :last-child { margin-bottom: 0px !important; }
.markdown-preview[data-use-github-style] a:not([href]) { color: inherit; text-decoration: none; }
.markdown-preview[data-use-github-style] .absent { color: rgb(204, 0, 0); }
.markdown-preview[data-use-github-style] .anchor { position: absolute; top: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; }
.markdown-preview[data-use-github-style] .anchor:focus { outline: none; }
.markdown-preview[data-use-github-style] h1, .markdown-preview[data-use-github-style] h2, .markdown-preview[data-use-github-style] h3, .markdown-preview[data-use-github-style] h4, .markdown-preview[data-use-github-style] h5, .markdown-preview[data-use-github-style] h6 { position: relative; margin-top: 1em; margin-bottom: 16px; font-weight: bold; line-height: 1.4; }
.markdown-preview[data-use-github-style] h1 .octicon-link, .markdown-preview[data-use-github-style] h2 .octicon-link, .markdown-preview[data-use-github-style] h3 .octicon-link, .markdown-preview[data-use-github-style] h4 .octicon-link, .markdown-preview[data-use-github-style] h5 .octicon-link, .markdown-preview[data-use-github-style] h6 .octicon-link { display: none; color: rgb(0, 0, 0); vertical-align: middle; }
.markdown-preview[data-use-github-style] h1:hover .anchor, .markdown-preview[data-use-github-style] h2:hover .anchor, .markdown-preview[data-use-github-style] h3:hover .anchor, .markdown-preview[data-use-github-style] h4:hover .anchor, .markdown-preview[data-use-github-style] h5:hover .anchor, .markdown-preview[data-use-github-style] h6:hover .anchor { padding-left: 8px; margin-left: -30px; text-decoration: none; }
.markdown-preview[data-use-github-style] h1:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h2:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h3:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h4:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h5:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h6:hover .anchor .octicon-link { display: inline-block; }
.markdown-preview[data-use-github-style] h1 tt, .markdown-preview[data-use-github-style] h2 tt, .markdown-preview[data-use-github-style] h3 tt, .markdown-preview[data-use-github-style] h4 tt, .markdown-preview[data-use-github-style] h5 tt, .markdown-preview[data-use-github-style] h6 tt, .markdown-preview[data-use-github-style] h1 code, .markdown-preview[data-use-github-style] h2 code, .markdown-preview[data-use-github-style] h3 code, .markdown-preview[data-use-github-style] h4 code, .markdown-preview[data-use-github-style] h5 code, .markdown-preview[data-use-github-style] h6 code { font-size: inherit; }
.markdown-preview[data-use-github-style] h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
.markdown-preview[data-use-github-style] h1 .anchor { line-height: 1; }
.markdown-preview[data-use-github-style] h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
.markdown-preview[data-use-github-style] h2 .anchor { line-height: 1; }
.markdown-preview[data-use-github-style] h3 { font-size: 1.5em; line-height: 1.43; }
.markdown-preview[data-use-github-style] h3 .anchor { line-height: 1.2; }
.markdown-preview[data-use-github-style] h4 { font-size: 1.25em; }
.markdown-preview[data-use-github-style] h4 .anchor { line-height: 1.2; }
.markdown-preview[data-use-github-style] h5 { font-size: 1em; }
.markdown-preview[data-use-github-style] h5 .anchor { line-height: 1.1; }
.markdown-preview[data-use-github-style] h6 { font-size: 1em; color: rgb(119, 119, 119); }
.markdown-preview[data-use-github-style] h6 .anchor { line-height: 1.1; }
.markdown-preview[data-use-github-style] p, .markdown-preview[data-use-github-style] blockquote, .markdown-preview[data-use-github-style] ul, .markdown-preview[data-use-github-style] ol, .markdown-preview[data-use-github-style] dl, .markdown-preview[data-use-github-style] table, .markdown-preview[data-use-github-style] pre { margin-top: 0px; margin-bottom: 16px; }
.markdown-preview[data-use-github-style] hr { height: 4px; padding: 0px; margin: 16px 0px; border: 0px none; background-color: rgb(231, 231, 231); }
.markdown-preview[data-use-github-style] ul, .markdown-preview[data-use-github-style] ol { padding-left: 2em; }
.markdown-preview[data-use-github-style] ul.no-list, .markdown-preview[data-use-github-style] ol.no-list { padding: 0px; list-style-type: none; }
.markdown-preview[data-use-github-style] ul ul, .markdown-preview[data-use-github-style] ul ol, .markdown-preview[data-use-github-style] ol ol, .markdown-preview[data-use-github-style] ol ul { margin-top: 0px; margin-bottom: 0px; }
.markdown-preview[data-use-github-style] li > p { margin-top: 16px; }
.markdown-preview[data-use-github-style] dl { padding: 0px; }
.markdown-preview[data-use-github-style] dl dt { padding: 0px; margin-top: 16px; font-size: 1em; font-style: italic; font-weight: bold; }
.markdown-preview[data-use-github-style] dl dd { padding: 0px 16px; margin-bottom: 16px; }
.markdown-preview[data-use-github-style] blockquote { padding: 0px 15px; color: rgb(119, 119, 119); border-left-width: 4px; border-left-style: solid; border-left-color: rgb(221, 221, 221); }
.markdown-preview[data-use-github-style] blockquote > :first-child { margin-top: 0px; }
.markdown-preview[data-use-github-style] blockquote > :last-child { margin-bottom: 0px; }
.markdown-preview[data-use-github-style] table { display: block; width: 100%; overflow: auto; word-break: keep-all; }
.markdown-preview[data-use-github-style] table th { font-weight: bold; }
.markdown-preview[data-use-github-style] table th, .markdown-preview[data-use-github-style] table td { padding: 6px 13px; border: 1px solid rgb(221, 221, 221); }
.markdown-preview[data-use-github-style] table tr { border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(255, 255, 255); }
.markdown-preview[data-use-github-style] table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
.markdown-preview[data-use-github-style] img { max-width: 100%; box-sizing: border-box; }
.markdown-preview[data-use-github-style] .emoji { max-width: none; }
.markdown-preview[data-use-github-style] span.frame { display: block; overflow: hidden; }
.markdown-preview[data-use-github-style] span.frame > span { display: block; float: left; width: auto; padding: 7px; margin: 13px 0px 0px; overflow: hidden; border: 1px solid rgb(221, 221, 221); }
.markdown-preview[data-use-github-style] span.frame span img { display: block; float: left; }
.markdown-preview[data-use-github-style] span.frame span span { display: block; padding: 5px 0px 0px; clear: both; color: rgb(51, 51, 51); }
.markdown-preview[data-use-github-style] span.align-center { display: block; overflow: hidden; clear: both; }
.markdown-preview[data-use-github-style] span.align-center > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: center; }
.markdown-preview[data-use-github-style] span.align-center span img { margin: 0px auto; text-align: center; }
.markdown-preview[data-use-github-style] span.align-right { display: block; overflow: hidden; clear: both; }
.markdown-preview[data-use-github-style] span.align-right > span { display: block; margin: 13px 0px 0px; overflow: hidden; text-align: right; }
.markdown-preview[data-use-github-style] span.align-right span img { margin: 0px; text-align: right; }
.markdown-preview[data-use-github-style] span.float-left { display: block; float: left; margin-right: 13px; overflow: hidden; }
.markdown-preview[data-use-github-style] span.float-left span { margin: 13px 0px 0px; }
.markdown-preview[data-use-github-style] span.float-right { display: block; float: right; margin-left: 13px; overflow: hidden; }
.markdown-preview[data-use-github-style] span.float-right > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: right; }
.markdown-preview[data-use-github-style] code, .markdown-preview[data-use-github-style] tt { padding: 0.2em 0px; margin: 0px; font-size: 85%; border-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157); }
.markdown-preview[data-use-github-style] code::before, .markdown-preview[data-use-github-style] tt::before, .markdown-preview[data-use-github-style] code::after, .markdown-preview[data-use-github-style] tt::after { letter-spacing: -0.2em; content: " "; }
.markdown-preview[data-use-github-style] code br, .markdown-preview[data-use-github-style] tt br { display: none; }
.markdown-preview[data-use-github-style] del code { text-decoration: inherit; }
.markdown-preview[data-use-github-style] pre > code { padding: 0px; margin: 0px; font-size: 100%; word-break: normal; white-space: pre; border: 0px; background: transparent; }
.markdown-preview[data-use-github-style] .highlight { margin-bottom: 16px; }
.markdown-preview[data-use-github-style] .highlight pre, .markdown-preview[data-use-github-style] pre { padding: 16px; overflow: auto; font-size: 85%; line-height: 1.45; border-radius: 3px; background-color: rgb(247, 247, 247); }
.markdown-preview[data-use-github-style] .highlight pre { margin-bottom: 0px; word-break: normal; }
.markdown-preview[data-use-github-style] pre { word-wrap: normal; }
.markdown-preview[data-use-github-style] pre code, .markdown-preview[data-use-github-style] pre tt { display: inline; max-width: initial; padding: 0px; margin: 0px; overflow: initial; line-height: inherit; word-wrap: normal; border: 0px; background-color: transparent; }
.markdown-preview[data-use-github-style] pre code::before, .markdown-preview[data-use-github-style] pre tt::before, .markdown-preview[data-use-github-style] pre code::after, .markdown-preview[data-use-github-style] pre tt::after { content: normal; }
.markdown-preview[data-use-github-style] kbd { display: inline-block; padding: 3px 5px; font-size: 11px; line-height: 10px; color: rgb(85, 85, 85); vertical-align: middle; border-style: solid; border-width: 1px; border-color: rgb(204, 204, 204) rgb(204, 204, 204) rgb(187, 187, 187); border-radius: 3px; box-shadow: rgb(187, 187, 187) 0px -1px 0px inset; background-color: rgb(252, 252, 252); }
.markdown-preview[data-use-github-style] a { color: rgb(51, 122, 183); }
.markdown-preview[data-use-github-style] code { color: inherit; }
.markdown-preview[data-use-github-style] pre.editor-colors { padding: 0.8em 1em; margin-bottom: 1em; font-size: 0.85em; border-radius: 4px; overflow: auto; }
.scrollbars-visible-always .markdown-preview pre.editor-colors::shadow .vertical-scrollbar, .scrollbars-visible-always .markdown-preview pre.editor-colors::shadow .horizontal-scrollbar { visibility: hidden; }
.scrollbars-visible-always .markdown-preview pre.editor-colors:hover::shadow .vertical-scrollbar, .scrollbars-visible-always .markdown-preview pre.editor-colors:hover::shadow .horizontal-scrollbar { visibility: visible; }
.markdown-preview, .markdown-preview[data-use-github-style] { font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; font-size: 16px; line-height: 1.6; word-wrap: break-word; overflow: scroll; box-sizing: border-box; padding: 20px; background-color: rgb(255, 255, 255); }
.markdown-preview > :first-child, .markdown-preview[data-use-github-style] > :first-child { margin-top: 0px !important; }
.markdown-preview > :last-child, .markdown-preview[data-use-github-style] > :last-child { margin-bottom: 0px !important; }
.markdown-preview a:not([href]), .markdown-preview[data-use-github-style] a:not([href]) { color: inherit; text-decoration: none; }
.markdown-preview .absent, .markdown-preview[data-use-github-style] .absent { color: rgb(204, 0, 0); }
.markdown-preview .anchor, .markdown-preview[data-use-github-style] .anchor { position: absolute; top: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; }
.markdown-preview .anchor:focus, .markdown-preview[data-use-github-style] .anchor:focus { outline: none; }
.markdown-preview h1, .markdown-preview[data-use-github-style] h1, .markdown-preview h2, .markdown-preview[data-use-github-style] h2, .markdown-preview h3, .markdown-preview[data-use-github-style] h3, .markdown-preview h4, .markdown-preview[data-use-github-style] h4, .markdown-preview h5, .markdown-preview[data-use-github-style] h5, .markdown-preview h6, .markdown-preview[data-use-github-style] h6 { position: relative; margin-top: 1em; margin-bottom: 16px; font-weight: bold; line-height: 1.4; }
.markdown-preview h1 .octicon-link, .markdown-preview[data-use-github-style] h1 .octicon-link, .markdown-preview h2 .octicon-link, .markdown-preview[data-use-github-style] h2 .octicon-link, .markdown-preview h3 .octicon-link, .markdown-preview[data-use-github-style] h3 .octicon-link, .markdown-preview h4 .octicon-link, .markdown-preview[data-use-github-style] h4 .octicon-link, .markdown-preview h5 .octicon-link, .markdown-preview[data-use-github-style] h5 .octicon-link, .markdown-preview h6 .octicon-link, .markdown-preview[data-use-github-style] h6 .octicon-link { display: none; color: rgb(0, 0, 0); vertical-align: middle; }
.markdown-preview h1:hover .anchor, .markdown-preview[data-use-github-style] h1:hover .anchor, .markdown-preview h2:hover .anchor, .markdown-preview[data-use-github-style] h2:hover .anchor, .markdown-preview h3:hover .anchor, .markdown-preview[data-use-github-style] h3:hover .anchor, .markdown-preview h4:hover .anchor, .markdown-preview[data-use-github-style] h4:hover .anchor, .markdown-preview h5:hover .anchor, .markdown-preview[data-use-github-style] h5:hover .anchor, .markdown-preview h6:hover .anchor, .markdown-preview[data-use-github-style] h6:hover .anchor { padding-left: 8px; margin-left: -30px; text-decoration: none; }
.markdown-preview h1:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h1:hover .anchor .octicon-link, .markdown-preview h2:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h2:hover .anchor .octicon-link, .markdown-preview h3:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h3:hover .anchor .octicon-link, .markdown-preview h4:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h4:hover .anchor .octicon-link, .markdown-preview h5:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h5:hover .anchor .octicon-link, .markdown-preview h6:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h6:hover .anchor .octicon-link { display: inline-block; }
.markdown-preview h1 tt, .markdown-preview[data-use-github-style] h1 tt, .markdown-preview h2 tt, .markdown-preview[data-use-github-style] h2 tt, .markdown-preview h3 tt, .markdown-preview[data-use-github-style] h3 tt, .markdown-preview h4 tt, .markdown-preview[data-use-github-style] h4 tt, .markdown-preview h5 tt, .markdown-preview[data-use-github-style] h5 tt, .markdown-preview h6 tt, .markdown-preview[data-use-github-style] h6 tt, .markdown-preview h1 code, .markdown-preview[data-use-github-style] h1 code, .markdown-preview h2 code, .markdown-preview[data-use-github-style] h2 code, .markdown-preview h3 code, .markdown-preview[data-use-github-style] h3 code, .markdown-preview h4 code, .markdown-preview[data-use-github-style] h4 code, .markdown-preview h5 code, .markdown-preview[data-use-github-style] h5 code, .markdown-preview h6 code, .markdown-preview[data-use-github-style] h6 code { font-size: inherit; }
.markdown-preview h1, .markdown-preview[data-use-github-style] h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
.markdown-preview h1 .anchor, .markdown-preview[data-use-github-style] h1 .anchor { line-height: 1; }
.markdown-preview h2, .markdown-preview[data-use-github-style] h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
.markdown-preview h2 .anchor, .markdown-preview[data-use-github-style] h2 .anchor { line-height: 1; }
.markdown-preview h3, .markdown-preview[data-use-github-style] h3 { font-size: 1.5em; line-height: 1.43; }
.markdown-preview h3 .anchor, .markdown-preview[data-use-github-style] h3 .anchor { line-height: 1.2; }
.markdown-preview h4, .markdown-preview[data-use-github-style] h4 { font-size: 1.25em; }
.markdown-preview h4 .anchor, .markdown-preview[data-use-github-style] h4 .anchor { line-height: 1.2; }
.markdown-preview h5, .markdown-preview[data-use-github-style] h5 { font-size: 1em; }
.markdown-preview h5 .anchor, .markdown-preview[data-use-github-style] h5 .anchor { line-height: 1.1; }
.markdown-preview h6, .markdown-preview[data-use-github-style] h6 { font-size: 1em; color: rgb(119, 119, 119); }
.markdown-preview h6 .anchor, .markdown-preview[data-use-github-style] h6 .anchor { line-height: 1.1; }
.markdown-preview p, .markdown-preview[data-use-github-style] p, .markdown-preview blockquote, .markdown-preview[data-use-github-style] blockquote, .markdown-preview ul, .markdown-preview[data-use-github-style] ul, .markdown-preview ol, .markdown-preview[data-use-github-style] ol, .markdown-preview dl, .markdown-preview[data-use-github-style] dl, .markdown-preview table, .markdown-preview[data-use-github-style] table, .markdown-preview pre, .markdown-preview[data-use-github-style] pre { margin-top: 0px; margin-bottom: 16px; }
.markdown-preview hr, .markdown-preview[data-use-github-style] hr { height: 4px; padding: 0px; margin: 16px 0px; border: 0px none; background-color: rgb(231, 231, 231); }
.markdown-preview ul, .markdown-preview[data-use-github-style] ul, .markdown-preview ol, .markdown-preview[data-use-github-style] ol { padding-left: 2em; }
.markdown-preview ul.no-list, .markdown-preview[data-use-github-style] ul.no-list, .markdown-preview ol.no-list, .markdown-preview[data-use-github-style] ol.no-list { padding: 0px; list-style-type: none; }
.markdown-preview ul ul, .markdown-preview[data-use-github-style] ul ul, .markdown-preview ul ol, .markdown-preview[data-use-github-style] ul ol, .markdown-preview ol ol, .markdown-preview[data-use-github-style] ol ol, .markdown-preview ol ul, .markdown-preview[data-use-github-style] ol ul { margin-top: 0px; margin-bottom: 0px; }
.markdown-preview li > p, .markdown-preview[data-use-github-style] li > p { margin-top: 16px; }
.markdown-preview dl, .markdown-preview[data-use-github-style] dl { padding: 0px; }
.markdown-preview dl dt, .markdown-preview[data-use-github-style] dl dt { padding: 0px; margin-top: 16px; font-size: 1em; font-style: italic; font-weight: bold; }
.markdown-preview dl dd, .markdown-preview[data-use-github-style] dl dd { padding: 0px 16px; margin-bottom: 16px; }
.markdown-preview blockquote, .markdown-preview[data-use-github-style] blockquote { padding: 0px 15px; color: rgb(119, 119, 119); border-left-width: 4px; border-left-style: solid; border-left-color: rgb(221, 221, 221); }
.markdown-preview blockquote > :first-child, .markdown-preview[data-use-github-style] blockquote > :first-child { margin-top: 0px; }
.markdown-preview blockquote > :last-child, .markdown-preview[data-use-github-style] blockquote > :last-child { margin-bottom: 0px; }
.markdown-preview table, .markdown-preview[data-use-github-style] table { display: block; width: 100%; overflow: auto; word-break: keep-all; }
.markdown-preview table th, .markdown-preview[data-use-github-style] table th { font-weight: bold; }
.markdown-preview table th, .markdown-preview[data-use-github-style] table th, .markdown-preview table td, .markdown-preview[data-use-github-style] table td { padding: 6px 13px; border: 1px solid rgb(221, 221, 221); }
.markdown-preview table tr, .markdown-preview[data-use-github-style] table tr { border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(255, 255, 255); }
.markdown-preview table tr:nth-child(2n), .markdown-preview[data-use-github-style] table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
.markdown-preview img, .markdown-preview[data-use-github-style] img { max-width: 100%; box-sizing: border-box; }
.markdown-preview .emoji, .markdown-preview[data-use-github-style] .emoji { max-width: none; }
.markdown-preview span.frame, .markdown-preview[data-use-github-style] span.frame { display: block; overflow: hidden; }
.markdown-preview span.frame > span, .markdown-preview[data-use-github-style] span.frame > span { display: block; float: left; width: auto; padding: 7px; margin: 13px 0px 0px; overflow: hidden; border: 1px solid rgb(221, 221, 221); }
.markdown-preview span.frame span img, .markdown-preview[data-use-github-style] span.frame span img { display: block; float: left; }
.markdown-preview span.frame span span, .markdown-preview[data-use-github-style] span.frame span span { display: block; padding: 5px 0px 0px; clear: both; color: rgb(51, 51, 51); }
.markdown-preview span.align-center, .markdown-preview[data-use-github-style] span.align-center { display: block; overflow: hidden; clear: both; }
.markdown-preview span.align-center > span, .markdown-preview[data-use-github-style] span.align-center > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: center; }
.markdown-preview span.align-center span img, .markdown-preview[data-use-github-style] span.align-center span img { margin: 0px auto; text-align: center; }
.markdown-preview span.align-right, .markdown-preview[data-use-github-style] span.align-right { display: block; overflow: hidden; clear: both; }
.markdown-preview span.align-right > span, .markdown-preview[data-use-github-style] span.align-right > span { display: block; margin: 13px 0px 0px; overflow: hidden; text-align: right; }
.markdown-preview span.align-right span img, .markdown-preview[data-use-github-style] span.align-right span img { margin: 0px; text-align: right; }
.markdown-preview span.float-left, .markdown-preview[data-use-github-style] span.float-left { display: block; float: left; margin-right: 13px; overflow: hidden; }
.markdown-preview span.float-left span, .markdown-preview[data-use-github-style] span.float-left span { margin: 13px 0px 0px; }
.markdown-preview span.float-right, .markdown-preview[data-use-github-style] span.float-right { display: block; float: right; margin-left: 13px; overflow: hidden; }
.markdown-preview span.float-right > span, .markdown-preview[data-use-github-style] span.float-right > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: right; }
.markdown-preview code, .markdown-preview[data-use-github-style] code, .markdown-preview tt, .markdown-preview[data-use-github-style] tt { padding: 0.2em 0px; margin: 0px; font-size: 85%; border-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157); }
.markdown-preview code::before, .markdown-preview[data-use-github-style] code::before, .markdown-preview tt::before, .markdown-preview[data-use-github-style] tt::before, .markdown-preview code::after, .markdown-preview[data-use-github-style] code::after, .markdown-preview tt::after, .markdown-preview[data-use-github-style] tt::after { letter-spacing: -0.2em; content: " "; }
.markdown-preview code br, .markdown-preview[data-use-github-style] code br, .markdown-preview tt br, .markdown-preview[data-use-github-style] tt br { display: none; }
.markdown-preview del code, .markdown-preview[data-use-github-style] del code { text-decoration: inherit; }
.markdown-preview pre > code, .markdown-preview[data-use-github-style] pre > code { padding: 0px; margin: 0px; font-size: 100%; word-break: normal; white-space: pre; border: 0px; background: transparent; }
.markdown-preview .highlight, .markdown-preview[data-use-github-style] .highlight { margin-bottom: 16px; }
.markdown-preview .highlight pre, .markdown-preview[data-use-github-style] .highlight pre, .markdown-preview pre, .markdown-preview[data-use-github-style] pre { padding: 16px; overflow: auto; font-size: 85%; line-height: 1.45; border-radius: 3px; background-color: rgb(247, 247, 247); }
.markdown-preview .highlight pre, .markdown-preview[data-use-github-style] .highlight pre { margin-bottom: 0px; word-break: normal; }
.markdown-preview pre, .markdown-preview[data-use-github-style] pre { word-wrap: normal; }
.markdown-preview pre code, .markdown-preview[data-use-github-style] pre code, .markdown-preview pre tt, .markdown-preview[data-use-github-style] pre tt { display: inline; max-width: initial; padding: 0px; margin: 0px; overflow: initial; line-height: inherit; word-wrap: normal; border: 0px; background-color: transparent; }
.markdown-preview pre code::before, .markdown-preview[data-use-github-style] pre code::before, .markdown-preview pre tt::before, .markdown-preview[data-use-github-style] pre tt::before, .markdown-preview pre code::after, .markdown-preview[data-use-github-style] pre code::after, .markdown-preview pre tt::after, .markdown-preview[data-use-github-style] pre tt::after { content: normal; }
.markdown-preview kbd, .markdown-preview[data-use-github-style] kbd { display: inline-block; padding: 3px 5px; font-size: 11px; line-height: 10px; color: rgb(85, 85, 85); vertical-align: middle; border-style: solid; border-width: 1px; border-color: rgb(204, 204, 204) rgb(204, 204, 204) rgb(187, 187, 187); border-radius: 3px; box-shadow: rgb(187, 187, 187) 0px -1px 0px inset; background-color: rgb(252, 252, 252); }
.markdown-preview, .markdown-preview[data-use-github-style], .markdown-preview code, .markdown-preview[data-use-github-style] code { color: rgb(51, 51, 51); }
.markdown-preview h1, .markdown-preview[data-use-github-style] h1, .markdown-preview h2, .markdown-preview[data-use-github-style] h2, .markdown-preview h3, .markdown-preview[data-use-github-style] h3, .markdown-preview h4, .markdown-preview[data-use-github-style] h4, .markdown-preview h5, .markdown-preview[data-use-github-style] h5, .markdown-preview h6, .markdown-preview[data-use-github-style] h6 { -webkit-font-smoothing: antialiased; cursor: text; }
.markdown-preview > h1:first-child, .markdown-preview[data-use-github-style] > h1:first-child, .markdown-preview > h1:first-child + h2, .markdown-preview[data-use-github-style] > h1:first-child + h2, .markdown-preview > h2:first-child, .markdown-preview[data-use-github-style] > h2:first-child, .markdown-preview > h3:first-child, .markdown-preview[data-use-github-style] > h3:first-child, .markdown-preview > h4:first-child, .markdown-preview[data-use-github-style] > h4:first-child, .markdown-preview > h5:first-child, .markdown-preview[data-use-github-style] > h5:first-child, .markdown-preview > h6:first-child, .markdown-preview[data-use-github-style] > h6:first-child { margin-top: 0px; padding-top: 0px; }
.markdown-preview a, .markdown-preview[data-use-github-style] a, .markdown-preview a code, .markdown-preview[data-use-github-style] a code { color: rgb(65, 131, 196); }
.markdown-preview a:first-child h1, .markdown-preview[data-use-github-style] a:first-child h1, .markdown-preview a:first-child h2, .markdown-preview[data-use-github-style] a:first-child h2, .markdown-preview a:first-child h3, .markdown-preview[data-use-github-style] a:first-child h3, .markdown-preview a:first-child h4, .markdown-preview[data-use-github-style] a:first-child h4, .markdown-preview a:first-child h5, .markdown-preview[data-use-github-style] a:first-child h5, .markdown-preview a:first-child h6, .markdown-preview[data-use-github-style] a:first-child h6 { margin-top: 0px; padding-top: 0px; }
.markdown-preview h1 + p, .markdown-preview[data-use-github-style] h1 + p, .markdown-preview h2 + p, .markdown-preview[data-use-github-style] h2 + p, .markdown-preview h3 + p, .markdown-preview[data-use-github-style] h3 + p, .markdown-preview h4 + p, .markdown-preview[data-use-github-style] h4 + p, .markdown-preview h5 + p, .markdown-preview[data-use-github-style] h5 + p, .markdown-preview h6 + p, .markdown-preview[data-use-github-style] h6 + p { margin-top: 0px; }
.markdown-preview li p.first, .markdown-preview[data-use-github-style] li p.first { display: inline-block; }
.markdown-preview ul, .markdown-preview[data-use-github-style] ul { list-style-type: disc; }
.markdown-preview ol, .markdown-preview[data-use-github-style] ol { list-style-type: decimal; }
.markdown-preview ul li > :first-child, .markdown-preview[data-use-github-style] ul li > :first-child, .markdown-preview ol li > :first-child, .markdown-preview[data-use-github-style] ol li > :first-child, .markdown-preview ul li ul:first-of-type, .markdown-preview[data-use-github-style] ul li ul:first-of-type, .markdown-preview ol li ul:first-of-type, .markdown-preview[data-use-github-style] ol li ul:first-of-type { margin-top: 0px; }
.markdown-preview ol > li, .markdown-preview[data-use-github-style] ol > li { list-style-type: inherit; }
.markdown-preview ul > li, .markdown-preview[data-use-github-style] ul > li { list-style-type: inherit; }
.markdown-preview dl dt:first-child, .markdown-preview[data-use-github-style] dl dt:first-child { padding: 0px; }
.markdown-preview dl dt > :first-child, .markdown-preview[data-use-github-style] dl dt > :first-child { margin-top: 0px; }
.markdown-preview dl dt > :last-child, .markdown-preview[data-use-github-style] dl dt > :last-child { margin-bottom: 0px; }
.markdown-preview dl dd > :first-child, .markdown-preview[data-use-github-style] dl dd > :first-child { margin-top: 0px; }
.markdown-preview dl dd > :last-child, .markdown-preview[data-use-github-style] dl dd > :last-child { margin-bottom: 0px; }
.markdown-preview blockquote p, .markdown-preview[data-use-github-style] blockquote p { font-size: 16px; line-height: 1.5; }
.markdown-preview pre.editor-colors, .markdown-preview[data-use-github-style] pre.editor-colors { padding: 16px; overflow: auto; font-size: 84%; line-height: 1.45; border-radius: 3px; background-color: rgb(255, 255, 255); }
.markdown-preview pre, .markdown-preview[data-use-github-style] pre, .markdown-preview pre.editor-colors, .markdown-preview[data-use-github-style] pre.editor-colors { margin-bottom: 16px; word-break: normal; }
.markdown-preview pre, .markdown-preview[data-use-github-style] pre, .markdown-preview code, .markdown-preview[data-use-github-style] code, .markdown-preview tt, .markdown-preview[data-use-github-style] tt, .markdown-preview pre.editor-colors, .markdown-preview[data-use-github-style] pre.editor-colors { font-family: Consolas, 'Liberation Mono', Courier, monospace; }
.markdown-preview .emoji, .markdown-preview[data-use-github-style] .emoji { height: 20px; width: 20px; }
.markdown-preview del, .markdown-preview[data-use-github-style] del { text-decoration: none; position: relative; }
.markdown-preview del::after, .markdown-preview[data-use-github-style] del::after { border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; content: ""; left: 0px; position: absolute; right: 0px; top: 50%; }
.markdown-preview .flash, .markdown-preview[data-use-github-style] .flash { animation: flash 1s ease-out 1; outline: rgba(255, 0, 0, 0) solid 1px; }
.markdown-preview .flash:not(li), .markdown-preview[data-use-github-style] .flash:not(li) { display: block; }
.markdown-preview.markdown-preview { font-size: 10pt; }
.bracket-matcher .region {
  border-bottom: 1px dotted lime;
  position: absolute;
}

.spell-check-misspelling .region {
  border-bottom: 2px dotted rgba(255, 51, 51, 0.75);
}

.gutter .line-number {
  background-size: 0px;
  transition: background-size 0.5s;
}
.gutter .line-number.quickfix {
  background-image: url(atom://atom-typescript/images/light-bulb.png);
  background-size: 16.66666667px;
  background-repeat: no-repeat;
  background-position: right center;
}

pre.editor-colors,
.host {
  background-color: #ffffff;
  color: #555555;
}
pre.editor-colors .invisible-character,
.host .invisible-character {
  color: rgba(85, 85, 85, 0.2);
}
pre.editor-colors .indent-guide,
.host .indent-guide {
  color: rgba(85, 85, 85, 0.2);
}
pre.editor-colors .wrap-guide,
.host .wrap-guide {
  background-color: rgba(85, 85, 85, 0.2);
}
pre.editor-colors .gutter,
.host .gutter {
  color: #555555;
  background: #ffffff;
}
pre.editor-colors .gutter .line-number.folded,
.host .gutter .line-number.folded,
pre.editor-colors .gutter .line-number:after,
.host .gutter .line-number:after,
pre.editor-colors .fold-marker:after,
.host .fold-marker:after {
  color: #e87b00;
}
pre.editor-colors .invisible,
.host .invisible {
  color: #555;
}
pre.editor-colors .selection .region,
.host .selection .region {
  background-color: #e1e1e1;
}
pre.editor-colors.is-focused .cursor,
.host.is-focused .cursor {
  border-color: #000000;
}
pre.editor-colors.is-focused .selection .region,
.host.is-focused .selection .region {
  background-color: #afc4da;
}
pre.editor-colors.is-focused .line-number.cursor-line-no-selection,
.host.is-focused .line-number.cursor-line-no-selection,
pre.editor-colors.is-focused .line.cursor-line,
.host.is-focused .line.cursor-line {
  background-color: rgba(255, 255, 134, 0.34);
}
pre.editor-colors .source.gfm,
.host .source.gfm {
  color: #444;
}
pre.editor-colors .gfm .markup.heading,
.host .gfm .markup.heading {
  color: #111;
}
pre.editor-colors .gfm .link,
.host .gfm .link {
  color: #888;
}
pre.editor-colors .gfm .variable.list,
.host .gfm .variable.list {
  color: #888;
}
pre.editor-colors .markdown .paragraph,
.host .markdown .paragraph {
  color: #444;
}
pre.editor-colors .markdown .heading,
.host .markdown .heading {
  color: #111;
}
pre.editor-colors .markdown .link,
.host .markdown .link {
  color: #888;
}
pre.editor-colors .markdown .link .string,
.host .markdown .link .string {
  color: #888;
}
.host(.is-focused) .cursor {
  border-color: #000000;
}
.host(.is-focused) .selection .region {
  background-color: #afc4da;
}
.host(.is-focused) .line-number.cursor-line-no-selection,
.host(.is-focused) .line.cursor-line {
  background-color: rgba(255, 255, 134, 0.34);
}
.comment {
  color: #999988;
  font-style: italic;
}
.string {
  color: #D14;
}
.string .source,
.string .meta.embedded.line {
  color: #5A5A5A;
}
.string .punctuation.section.embedded {
  color: #920B2D;
}
.string .punctuation.section.embedded .source {
  color: #920B2D;
}
.constant.numeric {
  color: #D14;
}
.constant.language {
  color: #606aa1;
}
.constant.character,
.constant.other {
  color: #606aa1;
}
.constant.symbol {
  color: #990073;
}
.constant.numeric.line-number.find-in-files .match {
  color: rgba(143, 190, 0, 0.63);
}
.variable {
  color: #008080;
}
.variable.parameter {
  color: #606aa1;
}
.keyword {
  color: #222;
  font-weight: bold;
}
.keyword.unit {
  color: #445588;
}
.keyword.special-method {
  color: #0086B3;
}
.storage {
  color: #222;
}
.storage.type {
  color: #222;
}
.entity.name.class {
  text-decoration: underline;
  color: #606aa1;
}
.entity.other.inherited-class {
  text-decoration: underline;
  color: #606aa1;
}
.entity.name.function {
  color: #900;
}
.entity.name.tag {
  color: #008080;
}
.entity.other.attribute-name {
  color: #458;
  font-weight: bold;
}
.entity.name.filename.find-in-files {
  color: #E6DB74;
}
.support.constant,
.support.function,
.support.type {
  color: #458;
}
.support.class {
  color: #008080;
}
.invalid {
  color: #F8F8F0;
  background-color: #00A8C6;
}
.invalid.deprecated {
  color: #F8F8F0;
  background-color: #8FBE00;
}
.meta.structure.dictionary.json > .string.quoted.double.json,
.meta.structure.dictionary.json > .string.quoted.double.json .punctuation.string {
  color: #000080;
}
.meta.structure.dictionary.value.json > .string.quoted.double.json {
  color: #d14;
}
.meta.diff,
.meta.diff.header {
  color: #75715E;
}
.css.support.property-name {
  font-weight: bold;
  color: #333;
}
.css.constant {
  color: #099;
}
.bracket-matcher .region {
  background-color: #C9C9C9;
  opacity: .7;
  border-bottom: 0 none;
}
</style>
  </head>
  <body class='markdown-preview'><h2 id="web-server">Web Server</h2>
<p>Node.js provides several modules for configuring and running a web server.  The three modules are the <strong>http</strong> module, the <strong>connect</strong> module, and the <strong>express</strong> module.  The following sections will examine each module, demonstrating how to setup a web server.   The lowest level module is the <strong>http</strong> module.  It is built into Node.js and does not need to be installed locally into each project.</p>
<h3 id="http-module">Http Module</h3>
<p>This module provides the simplest web server with very few options.  Requests from web clients can be processed and responses sent in reply.</p>
<h3 id="connect-module">Connect Module</h3>
<p>The Connect module builds upon the <strong>http</strong> module to provide additional capabilities.</p>
<p>The <strong>connect</strong> module is not bundled with Node.js and must be installed using NPM.  To install the module type the following command.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;npm&nbsp;install&nbsp;connect&nbsp;--save</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;npm&nbsp;install&nbsp;serve-static&nbsp;--save</span></span></div></pre>
<p>The save option, adds the Connect and Server Static module dependencies to the package.json file.  For more information on packages, see the NPM Packages section.</p>
<p>The following example is going to demonstrate how to setup a simple Connect web server that serves static content.  The Connect server comes with several supporting modules.  In this example, the <strong>serve-static</strong> module is being referenced to load up static content.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;http&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>http</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;connect&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>connect</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;serveStatic&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>serve-static</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>Observe the three require functions, loading the <strong>http</strong>, <strong>connect</strong> and <strong>serve-static</strong> modules.  Only module names are needed because the modules have been loaded via NPM into the <strong>node_modules</strong> folder for the project.</p>
<p>The next snippet of JavaScript demonstrates how to create a Connect web server object and configure a file path to serve static content from.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;app&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>connect</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta function-call js"><span class="entity name function js"><span>serveStatic</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>./www</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>Finally, using the <strong>http</strong> module a web server is fired up on port 8080 and will serve content from the folder specified in the previous snippet.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;webServer&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>http</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>createServer</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>app</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="variable other object js"><span>webServer</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>listen</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="constant numeric js"><span>8080</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<h3 id="express-module">Express Module</h3>
<p>The <strong>express</strong> module is not bundled with Node.js and must be installed using NPM.  To install the module type the following command.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;npm&nbsp;install&nbsp;express&nbsp;--save</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;npm&nbsp;install&nbsp;body-parser&nbsp;--save</span></span></div></pre>
<p>The save option, adds the connect module dependency to the package.json file.  For more information on packages, see the NPM Packages section.</p>
<p>The following example is going to demonstrate how to setup a simple Express web server that serves static content and can process HTTP request bodies.  The Express server comes with several supporting modules.  In this example, the <strong>body-parser</strong> module is being referenced to process the body content of HTTP requests.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;http&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>http</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;express&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>express</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;bodyParser&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>body-parser</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>Observe the three require functions, loading the <strong>http</strong>,  <strong>express</strong> and <strong>body-parser</strong> modules.  Only the module names are needed because the modules have been downloaded via NPM into the <strong>node_modules</strong> folder for the project.</p>
<p>To create the Express server, the <strong>express</strong> module is called as a function.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;app&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>express</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>Using the <strong>use</strong> function, the Express server can be configured to process many kinds of web server requests and serve up many kinds of content responses.  The code below will serve static web content such as HTML files from the <em>www</em> folder.  Also, HTTP requests that have a content body will be able to be parsed by the <strong>body-parser</strong> module.  Express supports many kinds of modules to processing requests, one example is a cookie parsing module.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span>app</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>/</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>express</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>static</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>./www</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>bodyParser</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>Finally, in similar fashion as the Connect server, the Express server will use the <strong>http</strong> module to fire up a web server on port 8080 using the configuration specified in the previous snippet.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;webServer&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>http</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>createServer</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>app</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="variable other object js"><span>webServer</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>listen</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="constant numeric js"><span>8080</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<h4 id="ssl-with-tls-and-https">SSL with TLS and HTTPS</h4>
<p>Setting up Express to support SSL is relatively simple. Instead of using the <strong>http</strong> module, the <strong>https</strong> module is used.  The <strong>https</strong> module functions very similarly to the <strong>http</strong> module and supports the same events for creating a server as the <strong>http</strong> module supports.</p>
<p>To use SSL, a key and certificate must first be generated.  To create the key and certificate, <strong>OpenSSL</strong> needs to be downloaded an installed.  OpenSSL is typically included with most Linux distros.  For Windows and Mac, a binary version can be downloaded.  To download a binary version, open a web browser and browse to the following URL: <a href="https://www.openssl.org/about/binaries.html">https://www.openssl.org/about/binaries.html</a>.</p>
<p>Once downloaded, run the following commands to create a private key, certificate request and a certificate.</p>
<p>Step 1. Create a Private Key</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;openssl&nbsp;genrsa&nbsp;-out&nbsp;key.pem&nbsp;1024</span></span></div></pre>
<p>Step 2. Create a Certificate Request</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;openssl&nbsp;req&nbsp;-new&nbsp;-sha256&nbsp;-key&nbsp;key.pem&nbsp;-out&nbsp;csr.pem</span></span></div></pre>
<p>Step 3. Create a Certificate</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;openssl&nbsp;x509&nbsp;-req&nbsp;-in&nbsp;csr.pem&nbsp;-signkey&nbsp;key.pem&nbsp;-out&nbsp;cert.pem</span></span></div></pre>
<p>Here is some sample code demonstrating how to setup an SSL connection using the <strong>https</strong> module.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;https&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>https</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;fs&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>fs</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;options&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;key</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="variable other object js"><span>fs</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>readFileSync</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>key.pem</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;cert</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="variable other object js"><span>fs</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>readFileSync</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>cert.pem</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="variable other object js"><span>https</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>createServer</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>options</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>req</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>res</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>end</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>hello&nbsp;world</span><span class="constant character escape js"><span>\n</span></span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>listen</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="constant numeric js"><span>8443</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>The <strong>fs</strong> module is required to read the private key and the public certificate.  The private key and public certificate are then passed as options in the <strong>https</strong> module to initialize and start the SSL-enabled web server.</p>
<p>An alternative option to configuring SSL directly on Express is to use a reverse proxy server like Nginx to handle SSL connections allowing the Node.js application to focus on serving content.</p>
<p>####Exercise - Create an Express Web Server</p>
<p>Step 1. From a terminal, change to the <strong>myproject</strong> folder.</p>
<p>Step 2. Create a new file named <strong>webServer.js</strong>, add the following code to it.  Copy and paste the code from this document being sure to actually review the code to understand what it is doing.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="meta function js"><span class="support class js"><span>module</span></span><span>.</span><span class="entity name function js"><span>exports</span></span><span>&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>webServerOptions</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>dbSqlLiteOptions</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>use&nbsp;strict</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function json js"><span class="entity name function js"><span>start</span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>http</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;express&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>express</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bodyParser&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>body-parser</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>q</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;restService&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>./restService.js</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;webSockets&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>./webSockets.js</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>express</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appStart&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>q</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>defer</span></span><span class="meta brace round js"><span>(</span><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;webServer</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;restServiceCloseDb</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;webSocketsCloseDb</span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function js"><span>setTimeout</span></span><span class="meta brace round js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;initialize&nbsp;the&nbsp;express&nbsp;web&nbsp;server&nbsp;and&nbsp;set&nbsp;a&nbsp;static&nbsp;route</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>/</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;express</span><span class="meta brace square js"><span>[</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>static</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta brace round js"><span>(</span></span><span class="variable other object js"><span>webServerOptions</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>rootFolder</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta brace round js"><span>)</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>bodyParser</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;if&nbsp;database&nbsp;options&nbsp;are&nbsp;set&nbsp;then&nbsp;add&nbsp;db&nbsp;config&nbsp;and&nbsp;routes</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>dbSqlLiteOptions</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;restServiceCloseDb&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>restService</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>app</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;dbSqlLiteOptions</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>configureRoutes</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;start&nbsp;listening...</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;webServer&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>http</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>createServer</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>app</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>webServer</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>listen</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>webServerOptions</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant js"><span>port</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;setup&nbsp;WebSocketServer</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;webSocketsCloseDb&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>webSockets</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>webServer</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;dbSqlLiteOptions</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;cleanUpExecuted&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="constant language boolean false js"><span>false</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="entity name function js"><span>cleanUp</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>fn</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;p</span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span class="keyword operator logical js"><span>!</span></span><span>cleanUpExecuted</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>fn&nbsp;</span><span class="keyword operator instanceof js"><span>instanceof</span></span><span>&nbsp;</span><span class="support class js"><span>Array</span></span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>?</span></span><span>&nbsp;</span><span class="variable other object js"><span>q</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant js"><span>all</span></span><span class="meta brace round js"><span>(</span></span><span>fn</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>fn</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>p</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>then</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>exiting...</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>process</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>exit</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleanUpExecuted&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>do&nbsp;something&nbsp;when&nbsp;app&nbsp;is&nbsp;closing</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>process</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>on</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>exit</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>cleanUp</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>bind</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="constant language null js"><span>null</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span>webSocketsCloseDb</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;restServiceCloseDb</span><span class="meta brace square js"><span>]</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>catches&nbsp;ctrl+c&nbsp;event</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>process</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>on</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>SIGINT</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>cleanUp</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>bind</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="constant language null js"><span>null</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span>webSocketsCloseDb</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;restServiceCloseDb</span><span class="meta brace square js"><span>]</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>catches&nbsp;uncaught&nbsp;exceptions</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>process</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>on</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>uncaughtException</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>cleanUp</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>bind</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="constant language null js"><span>null</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span>webSocketsCloseDb</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;restServiceCloseDb</span><span class="meta brace square js"><span>]</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>appStart</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>resolve</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric js"><span>0</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="variable other object js"><span>appStart</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>promise</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>Save the file, and close it.</p>
<p>Step 3. Create a new file named <strong>restService.js</strong>, add the following code to it.  Copy and paste the code from this document being sure to actually review the code to understand what it is doing.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="meta function js"><span class="support class js"><span>module</span></span><span>.</span><span class="entity name function js"><span>exports</span></span><span>&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>app</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>options</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;myApp&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;app</span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;myOptions&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;options</span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;fs&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>fs</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;sqlite3&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>sqlite3</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>verbose</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;q&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>q</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;db</span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;dbExists&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>fs</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>existsSync</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>myOptions</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>file</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;create&nbsp;and&nbsp;initialize&nbsp;the&nbsp;database&nbsp;if&nbsp;it&nbsp;does&nbsp;not&nbsp;exist</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span class="meta brace round js"><span>(</span></span><span class="keyword operator logical js"><span>!</span></span><span>dbExists</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>Creating&nbsp;database&nbsp;file:&nbsp;</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="variable other object js"><span>myOptions</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>file</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>fs</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>openSync</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>myOptions</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>file</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>w</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;db&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta class instance constructor"><span class="keyword operator new js"><span>new</span></span><span>&nbsp;</span><span class="entity name type instance js"><span>sqlite3.Database</span></span></span><span class="meta brace round js"><span>(</span></span><span class="variable other object js"><span>myOptions</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>file</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>serialize</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>Creating&nbsp;tables.</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>run</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>create&nbsp;table&nbsp;widgets&nbsp;(id&nbsp;integer&nbsp;primary&nbsp;key,&nbsp;name&nbsp;text&nbsp;not&nbsp;null,&nbsp;description&nbsp;text,&nbsp;color&nbsp;text,&nbsp;size&nbsp;text,&nbsp;quantity&nbsp;int&nbsp;not&nbsp;null)</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>run</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>create&nbsp;table&nbsp;eventlog&nbsp;(id&nbsp;integer&nbsp;primary&nbsp;key,&nbsp;source&nbsp;text&nbsp;not&nbsp;null,&nbsp;message&nbsp;text&nbsp;not&nbsp;null,&nbsp;severity&nbsp;int&nbsp;not&nbsp;null,&nbsp;created&nbsp;datetime&nbsp;not&nbsp;null)</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>Creating&nbsp;sample&nbsp;data.</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>run</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>insert&nbsp;into&nbsp;widgets&nbsp;(name,&nbsp;description,&nbsp;color,&nbsp;size,&nbsp;quantity)&nbsp;values&nbsp;(&#39;Red&nbsp;small&nbsp;gear&#39;,&nbsp;&#39;A&nbsp;red&nbsp;gear&nbsp;that&nbsp;is&nbsp;small.&#39;,&nbsp;&#39;red&#39;,&nbsp;&#39;small&#39;,&nbsp;100)</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>run</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>insert&nbsp;into&nbsp;widgets&nbsp;(name,&nbsp;description,&nbsp;color,&nbsp;size,&nbsp;quantity)&nbsp;values&nbsp;(&#39;Green&nbsp;large&nbsp;gear&#39;,&nbsp;&#39;A&nbsp;green&nbsp;gear&nbsp;that&nbsp;is&nbsp;large.&#39;,&nbsp;&#39;green&#39;,&nbsp;&#39;large&#39;,&nbsp;10)</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>run</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>insert&nbsp;into&nbsp;widgets&nbsp;(name,&nbsp;description,&nbsp;color,&nbsp;size,&nbsp;quantity)&nbsp;values&nbsp;(&#39;Blue&nbsp;tiny&nbsp;gear&#39;,&nbsp;&#39;A&nbsp;blue&nbsp;gear&nbsp;that&nbsp;is&nbsp;tiny.&#39;,&nbsp;&#39;blue&#39;,&nbsp;&#39;tiny&#39;,&nbsp;45)</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>run</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>insert&nbsp;into&nbsp;widgets&nbsp;(name,&nbsp;description,&nbsp;color,&nbsp;size,&nbsp;quantity)&nbsp;values&nbsp;(&#39;Orange&nbsp;medium&nbsp;gear&#39;,&nbsp;&#39;An&nbsp;orange&nbsp;gear&nbsp;that&nbsp;is&nbsp;medium.&#39;,&nbsp;&#39;orange&#39;,&nbsp;&#39;medium&#39;,&nbsp;23)</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span>&nbsp;</span><span class="keyword control js"><span>else</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;db&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta class instance constructor"><span class="keyword operator new js"><span>new</span></span><span>&nbsp;</span><span class="entity name type instance js"><span>sqlite3.Database</span></span></span><span class="meta brace round js"><span>(</span></span><span class="variable other object js"><span>myOptions</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>file</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function json js"><span class="entity name function js"><span>configureRoutes</span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;updates&nbsp;an&nbsp;existing&nbsp;record</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>myApp</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>put</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>/svc/widgets/:widgetId</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>req</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>res</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;widget&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>req</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>body</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stmt&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>prepare</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>update&nbsp;widgets&nbsp;set&nbsp;name&nbsp;=&nbsp;?,&nbsp;description&nbsp;=&nbsp;?,&nbsp;color&nbsp;=&nbsp;?,&nbsp;size&nbsp;=&nbsp;?,&nbsp;quantity&nbsp;=&nbsp;?&nbsp;where&nbsp;id&nbsp;=&nbsp;?</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>stmt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>run</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>widget</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>name</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>widget</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant js"><span>description</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>widget</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>color</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>widget</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>size</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>widget</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>quantity</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>req</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>params</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>widgetId</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>err</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>err</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>err</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span>&nbsp;</span><span class="keyword control js"><span>else</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta brace curly js"><span>{</span></span><span>&nbsp;widgets_updated</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="variable language js"><span>this</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>changes</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>stmt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>finalize</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;inserts&nbsp;a&nbsp;new&nbsp;record</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>myApp</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>post</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>/svc/widgets</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>req</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>res</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;widget&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>req</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>body</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stmt&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>prepare</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>insert&nbsp;into&nbsp;widgets&nbsp;(name,&nbsp;description,&nbsp;color,&nbsp;size,&nbsp;quantity)&nbsp;values&nbsp;(?,&nbsp;?,&nbsp;?,&nbsp;?,&nbsp;?)</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>stmt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>run</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>widget</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>name</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>widget</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant js"><span>description</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>widget</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>color</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>widget</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>size</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>widget</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>quantity</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>err</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>err</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>err</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span>&nbsp;</span><span class="keyword control js"><span>else</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta brace curly js"><span>{</span></span><span>&nbsp;widget_id</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="variable language js"><span>this</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>lastID</span></span><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>stmt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>finalize</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;deletes&nbsp;an&nbsp;existing&nbsp;record&nbsp;with&nbsp;the&nbsp;specified&nbsp;post&nbsp;id</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>myApp</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>delete</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>/svc/widgets/:widgetId</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>req</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>res</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;stmt&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>prepare</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>delete&nbsp;from&nbsp;widgets&nbsp;where&nbsp;id&nbsp;=&nbsp;?</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>stmt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>run</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>req</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>params</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>widgetId</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>err</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>err</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>err</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span>&nbsp;</span><span class="keyword control js"><span>else</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta brace curly js"><span>{</span></span><span>&nbsp;widgets_deleted</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="variable language js"><span>this</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>changes</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>stmt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>finalize</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;gets&nbsp;all&nbsp;records</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>myApp</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>get</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>/svc/widgets</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>req</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>res</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant js"><span>all</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>select&nbsp;*&nbsp;from&nbsp;widgets</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>err</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>widgets</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>err</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>err</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span>&nbsp;</span><span class="keyword control js"><span>else</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>widgets</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;gets&nbsp;a&nbsp;record&nbsp;by&nbsp;id</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>myApp</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>get</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>/svc/widgets/:widgetId</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>req</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>res</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>get</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>select&nbsp;*&nbsp;from&nbsp;widgets&nbsp;where&nbsp;id&nbsp;=&nbsp;?</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="variable other object js"><span>req</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>params</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>widgetId</span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>err</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>widget</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>err</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>err</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span>&nbsp;</span><span class="keyword control js"><span>else</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>json</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>widget</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;returns&nbsp;a&nbsp;function&nbsp;to&nbsp;close&nbsp;the&nbsp;database</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;deferred&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>q</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>defer</span></span><span class="meta brace round js"><span>(</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>closing&nbsp;the&nbsp;database</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function dom js"><span>close</span></span><span class="meta brace round js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>database&nbsp;closed</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>deferred</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>resolve</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="variable other object js"><span>deferred</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>promise</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>Save the file, and close it.</p>
<p>Step 4. Create a new file named <strong>webSockets.js</strong>, add the following code to it.  Copy and paste the code from this document being sure to actually review the code to understand what it is doing.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="meta function js"><span class="support class js"><span>module</span></span><span>.</span><span class="entity name function js"><span>exports</span></span><span>&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>webServer</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>options</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>use&nbsp;strict</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;WebSocketServer&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>ws</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>Server</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;wss&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta class instance constructor"><span class="keyword operator new js"><span>new</span></span><span>&nbsp;</span><span class="entity name type instance js"><span>WebSocketServer</span></span></span><span class="meta brace round js"><span>(</span></span><span class="meta brace curly js"><span>{</span></span><span>&nbsp;server</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;webServer&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;sqlite3&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>sqlite3</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>verbose</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;db&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta class instance constructor"><span class="keyword operator new js"><span>new</span></span><span>&nbsp;</span><span class="entity name type instance js"><span>sqlite3.Database</span></span></span><span class="meta brace round js"><span>(</span></span><span class="variable other object js"><span>options</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>file</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>wss</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>on</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>connection</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>ws</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>web&nbsp;sockets&nbsp;open</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>ws</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>on</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>error</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>data</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>web&nbsp;sockets&nbsp;error</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>ws</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>on</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>close</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>data</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>web&nbsp;sockets&nbsp;closed</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>ws</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>on</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>message</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>data</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>serialize</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>JSON</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js"><span>parse</span></span><span class="meta brace round js"><span>(</span></span><span>data</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stmt</span><span class="punctuation terminator statement js"><span>;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span class="variable other object js"><span>message</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>messageType</span></span><span>&nbsp;</span><span class="keyword operator comparison js"><span>===</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>log</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stmt&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>prepare</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>insert&nbsp;into&nbsp;eventlog&nbsp;(source,&nbsp;message,&nbsp;severity,&nbsp;created)&nbsp;values&nbsp;(?,&nbsp;?,&nbsp;?,&nbsp;?)</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>stmt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>run</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>message</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>messageData</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant js"><span>source</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>message</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>messageData</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>message</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="variable other object js"><span>message</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>messageData</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>severity</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta class instance constructor"><span class="keyword operator new js"><span>new</span></span><span>&nbsp;</span><span class="entity name type instance js"><span>Date</span></span></span><span class="meta brace round js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>err</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>err</span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span>err</span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>ws</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js"><span>send</span></span><span class="meta brace round js"><span>(</span></span><span>err</span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span>&nbsp;</span><span class="keyword control js"><span>else</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>ws</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js"><span>send</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>log&nbsp;request&nbsp;processed</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>stmt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>finalize</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;returns&nbsp;a&nbsp;function&nbsp;to&nbsp;close&nbsp;the&nbsp;database</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;deferred&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>q</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>defer</span></span><span class="meta brace round js"><span>(</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>closing&nbsp;the&nbsp;database</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>db</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function dom js"><span>close</span></span><span class="meta brace round js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>database&nbsp;closed</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>deferred</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>resolve</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="variable other object js"><span>deferred</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>promise</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>Save the file, and close it.</p>
<p><strong>Exercise Complete!</strong></p>
<h3 id="helmet-express-security">Helmet - Express Security</h3>
<h4 id="overview">Overview</h4>
<p>Helmet is an Express middleware module that is used to help enhance Express security. Helmet provides protection using Content Security Policy, XSS Filter, Click-Jacking, HTTP Strict Transport Security, and many other features. Essentially, Helmet produces response headers that the browser can choose to use to enforce certain client-side security options. Helmet cannot enforce the client-side security options and for older browsers they may not even support them. Nevertheless, Helmet is very helpful to make your application as secure as it can be on the client-side.  </p>
<h4 id="installation">Installation</h4>
<p>To get started with Helmet, install the Node.js package within the Node.js application.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;npm&nbsp;install&nbsp;helmet&nbsp;--save</span></span></div></pre>
<p>After installing Helmet, the Helmet module must be required as such.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;helmet&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>helmet</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>To use the default security settings that Helmet offers, use the following code.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;app&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>Express</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta function-call js"><span class="entity name function js"><span>helmet</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>In many cases, you will want to customize Helmet&#39;s configuration. The following sections cover the most common configuration options in more detail.</p>
<h4 id="content-security-policy-csp-">Content Security Policy (CSP)</h4>
<p>Content Security Policy is geared towards protecting against cross-site scripting attacks. It accomplishes this mission by informing the browser of safe sources of content through setting the <strong>Content-Security-Policy</strong> response header.  CSP can control the sources for most any kind of content that the browser downloads to display a web page such as JavaScript, images, stylesheets, fonts, etc...</p>
<p>Below is some sample code demonstrating how to configure CSP using Helmet.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>helmet</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>csp</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta brace curly js"><span>{</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;defaultSrc</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>&#39;self&#39;</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;scriptSrc</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>cdnjs.cloudflare.com</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;styleSrc</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>cdnjs.cloudflare.com</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;fontSrc</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>cdnjs.cloudflare.com</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace square js"><span>]</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span></span></div></pre>
<p>In the example above, Helmet is being configured to allow script, style and font downloads from a popular CDN service.  In addition, to the options listed above there are many more options that are available for configuration.  They include <strong>imgSrc</strong>, <strong>connectSrc</strong>, <strong>objectSrc</strong>, <strong>mediaSrc</strong>, <strong>frameSrc</strong>, <strong>sandbox</strong>, <strong>eportUri</strong>, <strong>reportOnly</strong>, <strong>setAllHeaders</strong>, and <strong>safari5</strong>.</p>
<p>If none of the other source values are set, then the default source value will be used.  The <strong>self</strong> value for default means to allow content from the same origin.</p>
<h4 id="xss-filter">XSS Filter</h4>
<p>The XSS filter helps to protect vulnerable versions of Internet Explorer against an XSS exploit by sending a header to disable XSS protection.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>helmet</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>xssFilter</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>The header for versions of IE with the exploit looks like this.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>X-XSS-Protection:&nbsp;0</span></span></div></pre>
<p>For browsers without the exploit, the header looks like this.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>X-XSS-Protection:&nbsp;1</span><span class="keyword operator list shell"><span>;</span></span><span>&nbsp;mode=block</span></span></div></pre>
<h4 id="click-jacking">Click-Jacking</h4>
<p>Click-jacking it attempting to deceive the user into clicking something on a web page other than what they think they are clicking on. Loading familiar web pages into an iFrame with no border then surrounding that content with malicious links can fool a user into clicking something they do not really intend to click. Using the <strong>X-Frame</strong> response header, Helmet will indicate to the web browser if the web page can be loaded into an iFrame.</p>
<p>To not allow the web page to be loaded into an iFrame, configure Helmet like this.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>helmet</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>xframe</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>The result <strong>X-Frame-Options</strong> response header sent to the browser looks like this.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>X-Frame-Options:&nbsp;DENY</span></span></div></pre>
<p>To allow the web page to be loaded into an iFrame within a web page from the same origin, use the following Helment configuration.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>helmet</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>xframe</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>sameorigin</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>The result <strong>X-Frame-Options</strong> response header sent to the browser looks like this.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>X-Frame-Options:&nbsp;SAMEORIGIN</span></span></div></pre>
<p>To allow the web page to be loaded into an iFrame for a specific URL, use the following Helmet configuration.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>helmet</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>xframe</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>allow-from</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span class="markup underline link http hyperlink"><span>http://www.somedomain.com</span></span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>The result <strong>X-Frame-Options</strong> response header sent to the browser looks like this.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>X-Frame-Options:&nbsp;ALLOW-FROM&nbsp;http://www.somedomain.com</span></span></div></pre>
<h4 id="http-strict-transport-security">HTTP Strict Transport Security</h4>
<p>HTTP Strict Transport Security (HSTS) is a method to inform user agents to use HTTPS instead of HTTP.  To configure Helmet to use HSTS, review the following code.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="variable other object js"><span>helmet</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>hsts</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta brace curly js"><span>{</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;maxAge</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant numeric js"><span>2592000000</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;30&nbsp;days&nbsp;in&nbsp;milliseconds</span><span>&nbsp;</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span>&nbsp;&nbsp;includeSubdomains</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta method-call js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>The above configuration will inform the user agent to make HTTPS request only for the next 30 days and to include all subdomains.</p>
<p>The HSTS response header to the browser will as follows.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>Strict-Transport-Security:&nbsp;max-age=2592000</span><span class="keyword operator list shell"><span>;</span></span><span>&nbsp;includeSubDomains</span></span></div></pre>
<h3 id="kraken-express-for-larger-applications">Kraken - Express for Larger Applications</h3>
<h4 id="overview">Overview</h4>
<p>Kraken is useful for larger Express applications.  Express does little to help isolate controller logic, from views and models and other content.  Kraken lays on top of Express to help structure these components to better facilitate larger application development.</p>
<p>From a system administration perspective, the most interesting aspect of Kraken is the security middleware module named Lusca. Lusca can be be used independent of Kraken and functions similar to Helmet.</p>
<h4 id="lusca-installation">Lusca Installation</h4>
<p>To install Lusca, use NPM to install the <strong>lusca</strong> package.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;npm&nbsp;install&nbsp;lusca&nbsp;--save</span></span></div></pre>
<p>Once installed, the Lusca module needs to be required as demonstrated here.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;lusca&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>lusca</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<h4 id="lusca-configuration">Lusca Configuration</h4>
<p>Lusca has many of the same configuration options as Helmet.  Here is a sample Lusca configuration.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>use</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta function-call js"><span class="entity name function js"><span>lusca</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta brace curly js"><span>{</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span>&nbsp;&nbsp;csrf</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span>&nbsp;&nbsp;csp</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span><span>&nbsp;policy</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>default-src</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>&#39;self&#39;</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>script-src</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>cdnjs.cloudflare.com</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>style-src</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>cdnjs.cloudflare.com</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>font-src</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>cdnjs.cloudflare.com</span><span class="punctuation definition string end js"><span>&quot;</span></span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span>&nbsp;&nbsp;xframe</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>SAMEORIGIN</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span>&nbsp;&nbsp;p3p</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>ABCDEF</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span>&nbsp;&nbsp;hsts</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span><span>maxAge</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant numeric js"><span>2592000</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;includeSubDomains</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span>&nbsp;&nbsp;xssProtection</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta function-call js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>There is one additional options offered by Lusca that is not covered by Helmet.  The <strong>P3P</strong> option stands for the Platform for Privacy Preferences Project.  This option communicates to end users what kind of data will be collected from them by the web site.</p>
<h2 id="scaling-node-js">Scaling Node.js</h2>
<h3 id="overview">Overview</h3>
<p>An instance of Node.js is limited to one process with one thread.  This is not so much a Node.js limitation as it is a JavaScript language limitation.  JavaScript both on the client and server is single-threaded.  As mentioned at the beginning of the document, what gives JavaScript and more specifically Node.js in this case, the appearance of concurrency is its fast running event loop that depends upon non-blocking execution achieved through asynchronous programming patterns.  Nevertheless, Node.js can scale through the creation of multiple instances where one instance runs per processor/core.  The management and configuration of the instances can be achieve through several approaches.  When standing up a Node.js web server, the two most commonly used approaches is to utilize the cluster module or use a reverse proxy server to map incoming client connections to multiple Node.js instances.  </p>
<h3 id="cluster-module">Cluster Module</h3>
<p>Because Node.js is single-threaded, an Express web server cannot serve requests from multiple threads.  To fully utilize computers with multiple processors and multiple cores per processor, multiple Node.js processes (one for each processor/core) can be coordinated from a master Node.js process to serve more requests.  From a stability perspective, if a single web server process crashes for any reason, no more requests will be able to be handled until its restarted.  There is no fault-tolerant, automatic fail over capability available within Node.js when running a single Node.js process instance, of a single-threaded web server.</p>
<p>To solve this problem, there is a cluster module that will enable Node.js to run multiple processes, each with their own Express web server.  To utilize the Cluster module, the Cluster NPM package needs to be locally installed, using the following command.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;npm&nbsp;install&nbsp;cluster&nbsp;--save</span></span></div></pre>
<p>After the Cluster module is installed, it can be used to launch a Node.js process for each <strong>CPU</strong> available on the computer.  According to Node.js, the number of <strong>CPUs</strong> is the number of physical processors multipled by the number of cores per processor.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="meta brace round js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>use&nbsp;strict</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="storage modifier js"><span>const</span></span><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;express&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>express</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;cluster&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>cluster</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;app&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>express</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="keyword control js"><span>if</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span class="variable other object js"><span>cluster</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>isMaster</span></span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;cpuCount&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>os</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>cpus</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant js"><span>length</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>while</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span>cpuCount</span><span class="keyword operator decrement js"><span>--</span></span><span class="meta brace round js"><span>)</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>cluster</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>fork</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span>&nbsp;</span><span class="keyword control js"><span>else</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>get</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>/</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>req</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>res</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>res</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js"><span>send</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>Hi&nbsp;from&nbsp;worker:&nbsp;</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="variable other object js"><span>cluster</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>worker</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>id</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>listen</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="constant numeric js"><span>8888</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>Express&nbsp;App&nbsp;is&nbsp;running&nbsp;with&nbsp;worker&nbsp;id&nbsp;</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="variable other object js"><span>cluster</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>worker</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>id</span></span><span>&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>...</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>(</span><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>A single script is used to setup the <strong>Master</strong> as well as spawn the <strong>Child</strong> processes.</p>
<h3 id="setting-up-a-reverse-proxy">Setting up a Reverse Proxy</h3>
<h4 id="nginx">Nginx</h4>
<h5 id="overview">Overview</h5>
<p>Nginx is a very popular web server that quickly serves static content while using a reverse proxy approach to serving up dynamic content produced by languages such as PHP, .NET, Java and Node.js.  Static content include plain HTML files, image files, JavaScript files, CSS styles and many other kinds of media files.  Nginx efficiently handles requests for static content and even provides caching capabilities.  A reverse proxy is a proxy that stands in front of several non-public servers providing the client a single point of entry and then maps the various client requests to the appropriate non-public server behind the proxy.</p>
<p>The first question is why use Nginx (or any web server as reverse proxy) instead of simply standing up Express on its own?  There are many debatable reasons for doing this setup.  Reasons include:</p>
<ul>
<li>Serving static content faster</li>
<li>Securely attached to port 80</li>
<li>SSL terminate at Nginx instead of managing SSL within Express</li>
</ul>
<p>The second question is why choose Nginx over other options?</p>
<ul>
<li>Nginx is preferred over other web front ends because it is non-blocking as well.  Although this is not a true as it used to be, recent web server versions of Apache and IIS, have adopted similar techniques for serving up content using non-blocking means. </li>
</ul>
<h5 id="installing-nginx">Installing Nginx</h5>
<p>Usually Express and Node.js are configured web applications through a proxy web server such as Nginx.  In this section, we are going to learn how to install and configure Nginx to serve Node.js Express web applications.</p>
<p>To install Nginx on Debian-based Linux distros, type the following command at a terminal.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;apt-get&nbsp;install&nbsp;nginx</span></span></div></pre>
<p>To install Nginx on RPM-based Linux distros, type the following command at a terminal.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;yum&nbsp;install&nbsp;nginx</span></span></div></pre>
<p>As part of the package installation for both Debian-based and RPM-based distros, the Nginx web server should start automatically on port 80.  To test, run the following command from a terminal.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;curl&nbsp;-i&nbsp;localhost</span></span></div></pre>
<p>If installed successfully, the output will be a <strong>Welcome to nginx!</strong> web page.</p>
<p>The <strong>nginx</strong> executable will be installed <strong>/usr/sbin/nginx</strong>.  The <strong>nginx</strong> configuration files will be installed in the <strong>/etc/nginx</strong>.</p>
<h5 id="configuring-nginx-node-js">Configuring Nginx &amp; Node.js</h5>
<p>After the installation of Nginx, an administrator can start, stop and restart the server as well as configure the web server to begin serving web sites. To start, stop and restart Nginx the following commands are used. These commands should work on Debian and Red Hat based Linux distros.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;service&nbsp;nginx&nbsp;start</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;service&nbsp;nginx&nbsp;stop</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;service&nbsp;nginx&nbsp;restart</span></span></div></pre>
<p>To setup the reverse proxy for a given site, an <strong>upstream</strong> configuration needs to be added.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>upstream&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>upstream&nbsp;name</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span>&nbsp;</span><span class="meta scope group shell"><span class="punctuation definition group shell"><span>{</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;server&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>ip&nbsp;address&nbsp;or&nbsp;domain&nbsp;name</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span>:</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>port&nbsp;number</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;server&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>ip&nbsp;address&nbsp;or&nbsp;domain&nbsp;name</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span>:</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>port&nbsp;number</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;keepalive&nbsp;8</span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="punctuation definition group shell"><span>}</span></span></span></span></div></pre>
<p>The <strong>upstream</strong> configuration lists the available servers for handling requests from the reverse proxy.  Depending upon the configuration, Nginx will load balance the incoming requests across the servers, handle failure conditions, etc..</p>
<p>Within a site&#39;s <strong>server</strong> configuration, the following settings need to be applied.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>location&nbsp;/&nbsp;</span><span class="meta scope group shell"><span class="punctuation definition group shell"><span>{</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;proxy_set_header&nbsp;X-Real-IO&nbsp;</span><span class="variable other normal shell"><span class="punctuation definition variable shell"><span>$</span></span><span>remote_addr</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;proxy_set_header&nbsp;X-Forwarded-For&nbsp;</span><span class="variable other normal shell"><span class="punctuation definition variable shell"><span>$</span></span><span>proxy_add_x_forwarded_for</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;proxy_set_header&nbsp;Host&nbsp;</span><span class="variable other normal shell"><span class="punctuation definition variable shell"><span>$</span></span><span>http_host</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;proxy_set_header&nbsp;X-NginX-Proxy&nbsp;</span><span class="support function builtin shell"><span>true</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;</span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;proxy_pass&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>upstream&nbsp;name</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;proxy_redirect&nbsp;off</span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="punctuation definition group shell"><span>}</span></span></span></span></div></pre>
<p>A complete site configuration file would look something similar to this.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>upstream&nbsp;node_server&nbsp;</span><span class="meta scope group shell"><span class="punctuation definition group shell"><span>{</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;server&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>first&nbsp;node&nbsp;server&nbsp;ip&nbsp;address</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span>:</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>first&nbsp;node&nbsp;server&nbsp;port</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;server&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>second&nbsp;node&nbsp;server&nbsp;ip&nbsp;address</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span>:</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>second&nbsp;node&nbsp;server&nbsp;port</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;keepalive&nbsp;8</span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="punctuation definition group shell"><span>}</span></span></span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>server&nbsp;</span><span class="meta scope group shell"><span class="punctuation definition group shell"><span>{</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;listen&nbsp;80&nbsp;default_server</span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;listen&nbsp;</span><span class="meta scope logical-expression shell"><span class="punctuation definition logical-expression shell"><span>[</span></span><span>::</span><span class="punctuation definition logical-expression shell"><span>]</span></span></span><span>:80&nbsp;default_server&nbsp;ipv6only=on</span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;</span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;server_name&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>some&nbsp;domain&nbsp;name</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;</span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;location&nbsp;/&nbsp;</span><span class="meta scope group shell"><span class="punctuation definition group shell"><span>{</span></span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;proxy_set_header&nbsp;X-Real-IO&nbsp;</span><span class="variable other normal shell"><span class="punctuation definition variable shell"><span>$</span></span><span>remote_addr</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;proxy_set_header&nbsp;X-Forwarded-For&nbsp;</span><span class="variable other normal shell"><span class="punctuation definition variable shell"><span>$</span></span><span>proxy_add_x_forwarded_for</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;proxy_set_header&nbsp;Host&nbsp;</span><span class="variable other normal shell"><span class="punctuation definition variable shell"><span>$</span></span><span>http_host</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;proxy_set_header&nbsp;X-NginX-Proxy&nbsp;</span><span class="support function builtin shell"><span>true</span></span><span class="keyword operator list shell"><span>;</span></span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="meta scope group shell"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;proxy_pass&nbsp;http://node_server</span><span class="keyword operator list shell"><span>;</span></span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;proxy_redirect&nbsp;off</span><span class="keyword operator list shell"><span>;</span></span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="meta scope group shell"><span>&nbsp;&nbsp;</span><span class="punctuation definition group shell"><span>}</span></span></span></span></span></div><div class="line"><span class="source shell"><span class="meta scope group shell"><span class="punctuation definition group shell"><span>}</span></span></span></span></div></pre>
<p>When setting up Express behind a proxy like Nginx, the Express application needs to be configured to trust the <strong>X-Forwarded-For</strong> header.  To enable Express to trust the proxy header, add the following code to the Express application.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>app</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>enable</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>trust&nbsp;proxy</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span></span></div></pre>
<h4 id="apache">Apache</h4>
<h5 id="overview">Overview</h5>
<p>Similar to Nginx, Apache can be configured to serve as the reverse proxy, load balancing requests made to it to any number of Node.js web servers on the backend.</p>
<h5 id="installation">Installation</h5>
<p>Installing Apache on CentOS is very simple, type and execute the following commands from a terminal.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;yum&nbsp;clean&nbsp;all</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;yum&nbsp;-y&nbsp;install&nbsp;httpd</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;systemctl&nbsp;start&nbsp;httpd</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;systemctl&nbsp;</span><span class="support function builtin shell"><span>enable</span></span><span>&nbsp;httpd</span></span></div></pre>
<h5 id="configuration">Configuration</h5>
<p>Once Apache is installed it needs to be configured. Configuration involving setting up a configuration file, changing Linux security permissions, and executing a Node.js application. These instructions assume there is collection of Node.js web server processes already running on the local ports of 8080 to 8089. The processes are typically executed independently, and protected against down time through the use of <strong>forever</strong>.</p>
<p>To configure Apache, and the Linux system security, type the following commands in a terminal.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;</span><span class="support function builtin shell"><span>cd</span></span><span>&nbsp;/etc/httpd/conf.d</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;vi&nbsp;nodesite.conf</span></span></div></pre>
<p>Copy and paste the following configuration into the configuration file.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span class="keyword operator redirect shell"><span>&lt;</span></span><span>VirtualHost&nbsp;</span><span class="keyword operator glob shell"><span>*</span></span><span>:</span><span class="keyword operator redirect shell"><span>80&gt;</span></span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>Proxy&nbsp;</span><span class="keyword operator glob shell"><span>*</span></span><span class="keyword operator redirect shell"><span>&gt;</span></span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Order&nbsp;deny,allow</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Allow&nbsp;from&nbsp;all</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>/Proxy</span><span class="keyword operator redirect shell"><span>&gt;</span></span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>Proxy&nbsp;balancer://mycluster</span><span class="keyword operator redirect shell"><span>&gt;</span></span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BalancerMember&nbsp;http://localhost:8081</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BalancerMember&nbsp;http://localhost:8082</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BalancerMember&nbsp;http://localhost:8083</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BalancerMember&nbsp;http://localhost:8084</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BalancerMember&nbsp;http://localhost:8085</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BalancerMember&nbsp;http://localhost:8086</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BalancerMember&nbsp;http://localhost:8087</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BalancerMember&nbsp;http://localhost:8088</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BalancerMember&nbsp;http://localhost:8089</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BalancerMember&nbsp;http://localhost:8090</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Require&nbsp;all&nbsp;granted</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProxySet&nbsp;lbmethod=byrequests</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>/Proxy</span><span class="keyword operator redirect shell"><span>&gt;</span></span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;ProxyPreserveHost&nbsp;On</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;ProxyRequests&nbsp;off</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProxyPass&nbsp;/&nbsp;balancer://mycluster/</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProxyPassReverse&nbsp;/&nbsp;balancer://mycluster/</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span class="keyword operator redirect shell"><span>&lt;</span></span><span>/VirtualHost</span><span class="keyword operator redirect shell"><span>&gt;</span></span></span></div></pre>
<p>Save the file, and exit the text editor. Next, type the following commands in the terminal.</p>
<h5 id="starting">Starting</h5>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;/usr/sbin/setsebool&nbsp;-P&nbsp;httpd_can_network_connect&nbsp;1</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;systemctl&nbsp;restart&nbsp;httpd</span></span></div></pre>
<p>The Apache server is now configured, and Linux has been configured to allow Apache to make local HTTP requests. Next, use <strong>curl</strong> or any web browser to make a request against the Apache web server, and confirm the Node.js web application serves up the expected page.</p>
<h4 id="firewall">Firewall</h4>
<p>Depending upon the Linux distro you are using there may or may not be firewall rules configured on the server.  Ubuntu 14.04 LTS does not install a firewall by default; therefore, one should be configured.</p>
<p>CentOS version 7 comes with a firewall configured with IP Tables.  To open port 80 for HTTP and port 443 for HTTPS, the following IP Tables command should be executed.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>iptables&nbsp;-A&nbsp;IN_public_allow&nbsp;-p&nbsp;tcp&nbsp;--dport&nbsp;80&nbsp;-j&nbsp;ACCEPT</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>iptables&nbsp;-A&nbsp;IN_public_allow&nbsp;-p&nbsp;tcp&nbsp;--dport&nbsp;443&nbsp;-j&nbsp;ACCEPT</span></span></div></pre>
<p>An alternative to using IP Tables directly, is to use <strong>firewalld</strong>. To open ports with <strong>firewalld</strong>, type the following commands.</p>
<p>If <strong>firewalld</strong> is not installed, then install it with <strong>yum</strong>, and configure to run on boot.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;yum&nbsp;install&nbsp;firewalld</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;systemctl&nbsp;start&nbsp;firewalld</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;systemctl&nbsp;</span><span class="support function builtin shell"><span>enable</span></span><span>&nbsp;firewalld</span></span></div></pre>
<p>Next, add the rules to allow connections over port 80 (HTTP) and port 443 (HTTPS).</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>sudo&nbsp;firewall-cmd&nbsp;--permanent&nbsp;--add-port=80/tcp</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>sudo&nbsp;firewall-cmd&nbsp;--permanent&nbsp;--add-port=443/tcp</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>sudo&nbsp;firewall-cmd&nbsp;--reload</span></span></div></pre>
<p>Be sure only to open the ports being serviced by Nginx or Apache.  The ports connecting to the Node.js web server directly should be blocked from outside access by the server and made available within the local network accessible by Nginx or Apache.</p>
<h4 id="testing-availability">Testing Availability</h4>
<p>Once the Node.js web server has been configured and is running, loading testing tools can be used to test the availability of the web server under load.  There are numerous tools available, for this course, we will be using a tool named <strong>Apache Bench</strong>.  Apache Bench is installed when the <strong>httpd</strong> RPM package is installed, so no additional installation steps are required.</p>
<p>Load testing a web site can be performed by using the following command.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;ab&nbsp;-n&nbsp;1000&nbsp;-c&nbsp;100&nbsp;http://</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>some&nbsp;ip&nbsp;address&nbsp;or&nbsp;domain&nbsp;name</span><span class="keyword operator redirect shell"><span>&gt;</span></span></span></div></pre>
<p>With these options, Apache Benchmark will fire up 100 connections and hammer the server with 1000 requests. When the load test is complete a report similar to this one will be shown.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>Server&nbsp;Software:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apache/2.4.6</span></span></div><div class="line"><span class="source shell"><span>Server&nbsp;Hostname:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localhost</span></span></div><div class="line"><span class="source shell"><span>Server&nbsp;Port:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;80</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>Document&nbsp;Path:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/</span></span></div><div class="line"><span class="source shell"><span>Document&nbsp;Length:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;128&nbsp;bytes</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>Concurrency&nbsp;Level:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100</span></span></div><div class="line"><span class="source shell"><span>Time&nbsp;taken&nbsp;</span><span class="keyword control shell"><span>for</span></span><span>&nbsp;tests:&nbsp;&nbsp;&nbsp;1.786&nbsp;seconds</span></span></div><div class="line"><span class="source shell"><span>Complete&nbsp;requests:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1000</span></span></div><div class="line"><span class="source shell"><span>Failed&nbsp;requests:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span></span></div><div class="line"><span class="source shell"><span>Write&nbsp;errors:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span></span></div><div class="line"><span class="source shell"><span>Total&nbsp;transferred:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;446000&nbsp;bytes</span></span></div><div class="line"><span class="source shell"><span>HTML&nbsp;transferred:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;128000&nbsp;bytes</span></span></div><div class="line"><span class="source shell"><span>Requests&nbsp;per&nbsp;second:&nbsp;&nbsp;&nbsp;&nbsp;559.93&nbsp;</span><span class="meta scope logical-expression shell"><span class="punctuation definition logical-expression shell"><span>[</span></span><span>#/sec</span><span class="punctuation definition logical-expression shell"><span>]</span></span></span><span>&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>mean</span><span class="punctuation definition subshell shell"><span>)</span></span></span></span></div><div class="line"><span class="source shell"><span>Time&nbsp;per&nbsp;request:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;178.595&nbsp;</span><span class="meta scope logical-expression shell"><span class="punctuation definition logical-expression shell"><span>[</span></span><span>ms</span><span class="punctuation definition logical-expression shell"><span>]</span></span></span><span>&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>mean</span><span class="punctuation definition subshell shell"><span>)</span></span></span></span></div><div class="line"><span class="source shell"><span>Time&nbsp;per&nbsp;request:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.786&nbsp;</span><span class="meta scope logical-expression shell"><span class="punctuation definition logical-expression shell"><span>[</span></span><span>ms</span><span class="punctuation definition logical-expression shell"><span>]</span></span></span><span>&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>mean,&nbsp;across&nbsp;all&nbsp;concurrent&nbsp;requests</span><span class="punctuation definition subshell shell"><span>)</span></span></span></span></div><div class="line"><span class="source shell"><span>Transfer&nbsp;rate:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;243.87&nbsp;</span><span class="meta scope logical-expression shell"><span class="punctuation definition logical-expression shell"><span>[</span></span><span>Kbytes/sec</span><span class="punctuation definition logical-expression shell"><span>]</span></span></span><span>&nbsp;received</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>Connection&nbsp;Times&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>ms</span><span class="punctuation definition subshell shell"><span>)</span></span></span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min&nbsp;&nbsp;mean</span><span class="meta scope logical-expression shell"><span class="punctuation definition logical-expression shell"><span>[</span></span><span>+/-sd</span><span class="punctuation definition logical-expression shell"><span>]</span></span></span><span>&nbsp;median&nbsp;&nbsp;&nbsp;max</span></span></div><div class="line"><span class="source shell"><span>Connect:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;0.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2</span></span></div><div class="line"><span class="source shell"><span>Processing:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;166&nbsp;&nbsp;42.5&nbsp;&nbsp;&nbsp;&nbsp;160&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;266</span></span></div><div class="line"><span class="source shell"><span>Waiting:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;158&nbsp;&nbsp;39.9&nbsp;&nbsp;&nbsp;&nbsp;155&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;236</span></span></div><div class="line"><span class="source shell"><span>Total:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;166&nbsp;&nbsp;42.2&nbsp;&nbsp;&nbsp;&nbsp;160&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;266</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>Percentage&nbsp;of&nbsp;the&nbsp;requests&nbsp;served&nbsp;within&nbsp;a&nbsp;certain&nbsp;</span><span class="keyword other shell"><span>time</span></span><span>&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>ms</span><span class="punctuation definition subshell shell"><span>)</span></span></span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;50%&nbsp;&nbsp;&nbsp;&nbsp;160</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;66%&nbsp;&nbsp;&nbsp;&nbsp;189</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;75%&nbsp;&nbsp;&nbsp;&nbsp;198</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;80%&nbsp;&nbsp;&nbsp;&nbsp;204</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;90%&nbsp;&nbsp;&nbsp;&nbsp;215</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;95%&nbsp;&nbsp;&nbsp;&nbsp;227</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;98%&nbsp;&nbsp;&nbsp;&nbsp;243</span></span></div><div class="line"><span class="source shell"><span>&nbsp;&nbsp;99%&nbsp;&nbsp;&nbsp;&nbsp;254</span></span></div><div class="line"><span class="source shell"><span>&nbsp;100%&nbsp;&nbsp;&nbsp;&nbsp;266&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span>longest&nbsp;request</span><span class="punctuation definition subshell shell"><span>)</span></span></span></span></div></pre>
<h3 id="best-option-cluster-or-nginx-apache-">Best Option? Cluster or Nginx/Apache?</h3>
<p>In terms of raw performance for handling request that execute Node.js code, both options are very effective.  Simply, there is no clear winner in terms of raw speed.  Nevertheless, Nginx/Apache is most likely a better choice because of the ability to cache and serve static content, configure SSL, as well as, support other non-Node.js web sites on the same server.  Additionally, Nginx/Apache can throttle connections and is most likely more reliable and stable than a simple Node.js process.</p>
<p>With Nginx/Apache publicly facing the clients, how should the Node.js processes behind the scenes be configured?  Should the cluster module be used and have multiple processes running on one port or should multiple processes be started on multiple ports and rely up Nginx/Apache to do the load balancing?  Regardless of the Node.js configuration, if multiple upstream servers are specified in the Nginx/Apache site configuration then Nginx/Apache will always be performing some kind of load balancing.  If Nginx/Apache is going to load balance anyway, then there is no need to load balance twice both on the Nginx/Apache and Node.js Cluster ends.  Therefore, it is best to let Nginx/Apache load balance and run each Node.js process independent of the other on its own port without using the Cluster module.</p>
<h2 id="keeping-node-js-going">Keeping Node.js Going</h2>
<h3 id="overview">Overview</h3>
<p>There are several options to keeping Node.js running when processes fail.  An older but popular option, is the use of the <strong>forever</strong> Node.js package.  A newer, growing in popularity approach, is to use Ubuntu&#39;s Monit and Upstart Linux packages to monitor the Node.js server application to keep it running.</p>
<h3 id="forever">Forever</h3>
<p>Forever is distributed as two Node.js packages named <strong>forever</strong> and <strong>forever-monitor</strong>.  The second package, <strong>forever-monitor</strong> is only needed if <strong>forever</strong> is going to be used programmatically.</p>
<p>The <strong>forever</strong> package should be install globally because it will be used from the command line.  To install <strong>forever</strong>, the following command should be executed from a terminal.  On Linux and Mac OS X, root privileges will be needed.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>npm&nbsp;install&nbsp;-g&nbsp;forever</span></span></div></pre>
<p>Forever offers many commands to manage the continued execution and recovery of Node.js processes.  To see a full listing of the commands, type the following command from a terminal.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>forever&nbsp;--help</span></span></div></pre>
<p>The best way to understand how <strong>forever</strong> works is to create test script that throws an error from which Forever can recover from and execute the script again.  Create a new file named <strong>error.js</strong>, then add the following code to it.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>running&nbsp;script...</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="support function js"><span>setTimeout</span></span><span class="meta brace round js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>throwing&nbsp;error...</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="keyword control js"><span>throw</span></span><span>&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>Error</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>error&nbsp;occurred</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="constant numeric js"><span>2000</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>From a terminal type the following command.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>forever&nbsp;-m&nbsp;5&nbsp;error.js</span></span></div></pre>
<p>This command will start the script <strong>error.js</strong> with Node.js.  After two seconds, an error will be thrown and the script will terminate. Upon termination, Forever will attempt to restart the script. The restart process will occur up to 5 times because of the <strong>-m</strong> option.</p>
<p>When Forever executes, it writes files to the <strong>.forever</strong> in the executing user&#39;s home folder. To change the location of Forever&#39;s folder, set the FOREVER_ROOT environment variable to the desired path. Make sure the user executing Forever has read and write permissions to the folder.</p>
<p>Forever can also because within Javascript code as part of a Node.js application.</p>
<h3 id="monit-upstart">Monit &amp; Upstart</h3>
<p>Monit and Upstart are applications that are installed on Ubuntu and can be used to monitor and start applications.  Monit and Upstart are not limited to Node.js, they can be used with any kind of application.  Nevertheless, on Ubuntu they have become a popular alternative to using Forever.</p>
<p>Upstart is installed as a part of the Ubunto distro.  One some systems Monit may need to be installed using the following command.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;apt-get&nbsp;install&nbsp;monit</span></span></div></pre>
<p>To configure Upstart to launch a Node.js application, a configuration file needs to be created in the <strong>/etc/init</strong> folder.  Create a new file named &quot;webapp.conf&quot;, and add the following configuration to it.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>description&nbsp;</span><span class="string quoted double shell"><span class="punctuation definition string begin shell"><span>&quot;</span></span><span>name&nbsp;of&nbsp;your&nbsp;file</span><span class="punctuation definition string end shell"><span>&quot;</span></span></span></span></div><div class="line"><span class="source shell"><span>author&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double shell"><span class="punctuation definition string begin shell"><span>&quot;</span></span><span>your&nbsp;name</span><span class="punctuation definition string end shell"><span>&quot;</span></span></span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>start&nbsp;on&nbsp;</span><span class="meta scope subshell shell"><span class="punctuation definition subshell shell"><span>(</span></span><span class="storage modifier shell"><span>local</span></span><span>-filesystems&nbsp;and&nbsp;net-device-up&nbsp;IFACE=eth0</span><span class="punctuation definition subshell shell"><span>)</span></span></span></span></div><div class="line"><span class="source shell"><span>stop&nbsp;&nbsp;on&nbsp;shutdown</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>respawn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign shell"><span class="punctuation definition comment shell"><span>#</span></span><span>&nbsp;restart&nbsp;when&nbsp;job&nbsp;dies</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source shell"><span>respawn&nbsp;limit&nbsp;5&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign shell"><span class="punctuation definition comment shell"><span>#</span></span><span>&nbsp;give&nbsp;up&nbsp;restart&nbsp;after&nbsp;5&nbsp;respawns&nbsp;in&nbsp;60&nbsp;seconds</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>script</span></span></div><div class="line"><span class="source shell"><span class="support function builtin shell"><span>exec</span></span><span>&nbsp;sudo&nbsp;-u&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>user</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span>&nbsp;/usr/local/bin/node&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>path&nbsp;to&nbsp;script</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span>/webapp.js&nbsp;</span><span class="keyword operator redirect shell"><span>&gt;&gt;</span></span><span>&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>path&nbsp;to&nbsp;logs</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span>/webapp.log&nbsp;</span><span class="keyword operator redirect shell"><span>2&gt;&amp;1</span></span></span></div><div class="line"><span class="source shell"><span>end&nbsp;script</span></span></div></pre>
<p>After creating the Upstart configuration file, run the following commands to ensure the log file exists and is writable.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;sudo&nbsp;touch&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>path&nbsp;to&nbsp;logs</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span>/webapp.log</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;sudo&nbsp;chmod&nbsp;775&nbsp;</span><span class="keyword operator redirect shell"><span>&lt;</span></span><span>path&nbsp;to&nbsp;logs</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span>/webapp.log</span></span></div></pre>
<p>To start the new web application, type the following command in the terminal.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;sudo&nbsp;service&nbsp;webapp&nbsp;start</span></span></div></pre>
<p>To verify the web application is running use <strong>curl</strong> to retrieve the home page of the web application.</p>
<p>After Upstart is configured, then Monit needs to be configured. You will notice that Upstart does have <strong>respawn</strong> capabilities and you may question why Monit is needed. Upstart checks for the PID to see if a respawn is needed.  While this is good, it is possible the process is still running but the application is not serving page requests.  In such a situation, Upstart would fail to detect this situation because there would be a running process.  Monit is used to actually ping the web application via HTTP to make sure it is still responding to requests.</p>
<p>To configure Monit, we first need to modify Monit&#39;s configuration before adding the configuration for the web application.  Open the file <strong>/etc/monir/monitrc</strong> in a text editor and uncomment the following lines.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span class="support function builtin shell"><span>set</span></span><span>&nbsp;httpd&nbsp;port&nbsp;2812&nbsp;and</span></span></div><div class="line"><span class="source shell"><span>use&nbsp;address&nbsp;localhost&nbsp;&nbsp;</span><span class="comment line number-sign shell"><span class="punctuation definition comment shell"><span>#</span></span><span>&nbsp;only&nbsp;accept&nbsp;connection&nbsp;from&nbsp;localhost</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source shell"><span>allow&nbsp;localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign shell"><span class="punctuation definition comment shell"><span>#</span></span><span>&nbsp;allow&nbsp;localhost&nbsp;to&nbsp;connect&nbsp;to&nbsp;the&nbsp;server&nbsp;and</span><span>&nbsp;</span></span></span></div></pre>
<p>Save the file and close it.  Restart the Monit process with following command.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;sudo&nbsp;service&nbsp;monit&nbsp;restart</span></span></div></pre>
<p>Finally, we need to create a Monit configuration file for the application.  Create file named <strong>webapp.monitrc</strong> in the <strong>/etc/monit/conf.d</strong> folder.  Add the following configuration to it.</p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>check&nbsp;host&nbsp;&lt;name&nbsp;of&nbsp;Upstart&nbsp;service&gt;&nbsp;with&nbsp;address&nbsp;&lt;ip&nbsp;address/domain&nbsp;name&nbsp;of&nbsp;website&gt;</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>start&nbsp;&quot;/sbin/start&nbsp;webapp&quot;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;stop&nbsp;&quot;/sbin/stop&nbsp;webapp&quot;</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;failed&nbsp;port&nbsp;&lt;port&nbsp;number&nbsp;of&nbsp;web&nbsp;app&gt;&nbsp;protocol&nbsp;HTTP</span></span></span></div><div class="line"><span class="text plain"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta paragraph text"><span>request&nbsp;/</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;timeout&nbsp;5&nbsp;seconds</span></span></span></div><div class="line"><span class="text plain"><span class="meta paragraph text"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;restart</span></span></span></div></pre><p>To start the Monit configuration for <strong>webapp</strong>, type the following command in a terminal.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;sudo&nbsp;monit&nbsp;start&nbsp;webapp</span></span></div></pre>
<p>Now Monit will be monitoring the <strong>webapp</strong> Upstart service. To view the status of Monit, type the following command in a terminal.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;sudo&nbsp;monit&nbsp;status</span></span></div></pre>
<p>To see Monit in action, simply kill the <strong>webapp</strong> Node.js process and check the Monit status every couple of seconds.  First, it will fail, then you will see it restart and resume successful connections.  The entire process can take a few minutes.</p>
<h2 id="grunt">Grunt</h2>
<p>Grunt is a JavaScript Task Runner.  Grunt provides a framework to configure and execute tasks using JavaScript.  Grunt tasks are written as Grunt Plugins, configured with a file named Gruntfile.js, and then executed.</p>
<h3 id="installation">Installation</h3>
<p>Grunt is distributed through two Node.js packages with the package ids: <strong>grunt</strong> and <strong>grunt-cli</strong>.  The <strong>grunt</strong> package is installed locally as a development dependency within your Node.js project.  The <strong>grunt-cli</strong> package is installed globally.  The local package provides the core grunt functionality.  The global package allows the <strong>grunt</strong> command to be executed from a terminal.</p>
<p>To install the local, core package, run the following command in a terminal from the main folder of your project.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;npm&nbsp;install&nbsp;grunt&nbsp;--save-dev</span></span></div></pre>
<p>To install the global, command line tool package, run the following command in a terminal from any folder on on your computer.  For Mac and Linux computers, you will need to run the command as root.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;npm&nbsp;install&nbsp;-g&nbsp;grunt-cli</span></span></div></pre>
<h3 id="tasks">Tasks</h3>
<p>To create Grunt tasks, a file named Gruntfile.js must be created in the project folder.  At the top of the file add the following code.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="meta function js"><span class="support class js"><span>module</span></span><span>.</span><span class="entity name function js"><span>exports</span></span><span>&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>grunt</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>use&nbsp;strict</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;task&nbsp;code&nbsp;will&nbsp;go&nbsp;here...</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>The grunt parameter refers to the local, core grunt NPM package.</p>
<p>The grunt file can be divided into two parts: configuration and tasks.  Configuration is performed using the <strong>initConfig</strong> function.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>initConfig</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;webServer</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;port</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant numeric js"><span>8080</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;rootFolder</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>./www</span><span class="punctuation definition string end js"><span>&#39;</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>The initConfig function expects a JavaScript object that will contain properties that define configuration values for the grunt tasks.</p>
<p>To define a task the following</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>registerTask</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>default</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>Start&nbsp;a&nbsp;web&nbsp;server</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;task&nbsp;code&nbsp;&nbsp;</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>The first parameter to <strong>registerTask</strong> is the name of the task.  If the task is the default task, then the name <em>default</em> can be used.  The second parameter is a short description of the task.  Finally, the third parameter is a function that defines the task.  The task can do anything the developer would like it to do.</p>
<p>To retrieve the configuration information defined with <strong>initConfig</strong> the <strong>config</strong> function is used.  To retrieve the <strong>webServer</strong> configuration defined below the following code is used.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;webServerOptions&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>config</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>webServer</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;output&nbsp;8080&nbsp;to&nbsp;the&nbsp;console</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="variable other object js"><span>webServerOptions</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant js"><span>port</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>To run the default task of the grunt file, simply type <strong>grunt</strong> on the command line and press enter.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>registerTask</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>webserver</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>Start&nbsp;a&nbsp;web&nbsp;server</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;task&nbsp;code&nbsp;here...</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>To execute a named task such as <em>webserver</em> listed above, execute the task with the following command.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;grunt&nbsp;webserver</span></span></div></pre>
<p>Also, Grunt allows the passing of arguments from the command line into a task. Updating the web server task to accept a port parameters allows the port number to be passed from the command line.  The register task definition would be modified to look like this.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>registerTask</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>webserver</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>Start&nbsp;a&nbsp;web&nbsp;server</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>port</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;task&nbsp;code&nbsp;here...</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>When invoked from the terminal, the Grunt command to run the web server task with a specific port number has the following syntax.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;grunt&nbsp;webserver:8080</span></span></div></pre>
<p>Arguments passed in from the command line are colon delimited.  In the case of a string value, the argument syntax is formatted like this.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;grunt&nbsp;sometask:</span><span class="string quoted double shell"><span class="punctuation definition string begin shell"><span>&quot;</span></span><span>Some&nbsp;Text&nbsp;Here...</span><span class="punctuation definition string end shell"><span>&quot;</span></span></span></span></div></pre>
<p>The string value is wrapped in quotes to allow for spaces in the string value.</p>
<h3 id="executing-an-external-program">Executing An External Program</h3>
<p>Within Grunt tasks, a common operation is launch an external program. Here is some sample code demonstrating how to launch external programs.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;exec&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>child_process</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>exec</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span class="storage type var js"><span>var</span></span><span>&nbsp;</span><span class="support variable js"><span>process</span></span><span>&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>exec</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>ls&nbsp;-al</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>error</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>stdout</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>stderr</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;do&nbsp;something&nbsp;once&nbsp;the&nbsp;process&nbsp;ends</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<h3 id="asynchronous-tasks">Asynchronous Tasks</h3>
<p>When running grunt tasks, the task will end even if asynchronous operations are waiting to complete.  The best example would be a web server.  With a typical grunt task, if a web server is started, it will be stopped as soon as the grunt task completes.  This is not desired since the web server needs to continue to run in order to handle requests.  To keep a grunt task running indefinitely, the following function must be called in the grunt task.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable language js"><span>this</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>async</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<h4 id="exercise-setup-grunt-tasks">Exercise - Setup Grunt Tasks</h4>
<p>Step 1. From a terminal, change to the <strong>myproject</strong> folder.</p>
<p>Step 2. Create a new file named <strong>Gruntfile.js</strong>, add the following code to it.  Copy and paste the code from this document being sure to actually review the code to understand what it is doing.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="meta function js"><span class="support class js"><span>module</span></span><span>.</span><span class="entity name function js"><span>exports</span></span><span>&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>grunt</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>use&nbsp;strict</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>initConfig</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;browserify</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;js</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>app/js/app.js</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dest</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>dist/js/app.js</span><span class="punctuation definition string end js"><span>&#39;</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;watch</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>**/*.html</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>**/*.css</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>**/*.tpl</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tasks</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>copy</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spawn</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean false js"><span>false</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cwd</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span><span>&nbsp;files</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>app/</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scripts</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>**/*.js</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tasks</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>browserify</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>uglify</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spawn</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean false js"><span>false</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cwd</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span><span>&nbsp;files</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>app/</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;angularjs</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>node_modules/angular/angular.min.js</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tasks</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>copy</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spawn</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean false js"><span>false</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cwd</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span><span>&nbsp;files</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>/</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;less</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>**/*.less</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tasks</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>less</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>cssmin</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spawn</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean false js"><span>false</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cwd</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span><span>&nbsp;files</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>app/</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;copy</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cwd</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>app/</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>**/*.html</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>**/*.css</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>**/*.tpl</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dest</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>dist/</span><span class="punctuation definition string end js"><span>&#39;</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;angularjs</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cwd</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>node_modules/angular</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>angular.min.js</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dest</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>dist/js</span><span class="punctuation definition string end js"><span>&#39;</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bootstrapcss</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cwd</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>node_modules/bootstrap/dist/css</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>*</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dest</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>dist/css</span><span class="punctuation definition string end js"><span>&#39;</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bootstrapfonts</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cwd</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>node_modules/bootstrap/dist/fonts</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>*</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dest</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>dist/fonts</span><span class="punctuation definition string end js"><span>&#39;</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;less</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;development</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paths</span><span class="keyword operator js"><span>:</span></span><span class="meta brace square js"><span>[</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>app/less</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace square js"><span>]</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>dist/css/app.css</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>app/less/app.less</span><span class="punctuation definition string end js"><span>&quot;</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;cssmin</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minify</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expand</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant language boolean true js"><span>true</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cwd</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>dist/css</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>*.css</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>!*.min.css</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dest</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>dist/css</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ext</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>.min.css</span><span class="punctuation definition string end js"><span>&#39;</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;uglify</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my_target</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;files</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>dist/js/app.min.js</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>dist/js/app.js</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;webServer</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="constant numeric js"><span>8080</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rootFolder</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>./dist</span><span class="punctuation definition string end js"><span>&#39;</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;dbSqlLite</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file</span><span class="keyword operator js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>lab.db</span><span class="punctuation definition string end js"><span>&quot;</span></span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>loadNpmTasks</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>grunt-browserify</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>loadNpmTasks</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>grunt-contrib-copy</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>loadNpmTasks</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>grunt-contrib-watch</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>loadNpmTasks</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>grunt-contrib-less</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>loadNpmTasks</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>grunt-contrib-cssmin</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>loadNpmTasks</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>grunt-contrib-uglify</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>event</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>on</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>watch</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>action</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>filepath</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>target</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>log</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function dom js"><span>writeln</span></span><span class="meta brace round js"><span>(</span></span><span>target&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>:&nbsp;</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;filepath&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>&nbsp;has&nbsp;</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;action</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;register&nbsp;a&nbsp;task&nbsp;to&nbsp;run&nbsp;the&nbsp;express&nbsp;server</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>registerTask</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>webserver</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>Start&nbsp;a&nbsp;web&nbsp;server</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;webServerOptions&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>config</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>webServer</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dbSqlLiteOptions&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>config</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>dbSqlLite</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;webServer&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>./webServer</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;tells&nbsp;the&nbsp;task&nbsp;this&nbsp;will&nbsp;run&nbsp;async&nbsp;otherwise&nbsp;the&nbsp;task&nbsp;will</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;end&nbsp;the&nbsp;web&nbsp;server&nbsp;when&nbsp;it&nbsp;completes&nbsp;this&nbsp;method</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>this.async();</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>webServer</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span>webServerOptions</span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;dbSqlLiteOptions</span><span class="punctuation definition arguments end js"><span>)</span></span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant dom js"><span>start</span></span><span class="meta brace round js"><span>(</span><span>)</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>then</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>log</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function dom js"><span>writeln</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>Started&nbsp;connect&nbsp;web&nbsp;server&nbsp;on&nbsp;port&nbsp;</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="variable other object js"><span>webServerOptions</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="support constant js"><span>port</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>log</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function dom js"><span>writeln</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>ctrl+c&nbsp;to&nbsp;exit</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>catch</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span>&nbsp;</span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>err</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>log</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>error</span></span><span class="meta brace round js"><span>(</span></span><span class="variable other object js"><span>err</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>message</span></span><span>&nbsp;</span><span class="keyword operator logical js"><span>||</span></span><span>&nbsp;err</span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>registerTask</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>default</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>browserify</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>less</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>cssmin</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>copy</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>uglify</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>webserver</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>watch</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>Save the file, and close it.</p>
<p>Step 3. From the terminal, type the command <strong>grunt</strong> and press <strong>enter</strong>.  This command fire up the default Grunt task.  For this Grunt file, the default Grunt task will launch the web server, configure web sockets, initialize the database, as well as, setup file watchers to execute various development tasks related to packaging modules, compiling preprocessor code and performing file combination and minification.</p>
<p>Step 4. What is the difference between the <strong>app</strong> folder and the <strong>dist</strong> folder?  What is the purpose of each?</p>
<p><strong>Exercise Complete!</strong></p>
<h3 id="grunt-plugins">Grunt Plugins</h3>
<p>Grunt plugins allow developers to create generalized tasks that can be reused in many projects.  Typically, Grunt plugins are distributed via NPM and contain logic to perform tasks using the configuration provided by the project that is including the plugin.  Developing Grunt plugins is very simple to do.</p>
<p>First, create a folder named after your plugin. In this example, we will use the name <strong>mygruntplugin</strong>.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;mkdir&nbsp;mygruntplugin</span></span></div></pre>
<p>Change to the folder you created, then create a tasks folder.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;</span><span class="support function builtin shell"><span>cd</span></span><span>&nbsp;mygruntplugin</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;mkdir&nbsp;tasks</span></span></div></pre>
<p>Next, create a <strong>package.json</strong> file with <strong>npm init</strong>, answering the questions as appropriate.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;npm&nbsp;init</span></span></div></pre>
<p>At a minimum, add a local <strong>grunt</strong> Node.js package to the Grunt plugin package.</p>
<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>$&nbsp;npm&nbsp;install&nbsp;grunt&nbsp;--save-dev</span></span></span></div></pre><p>Then change to the tasks folder, and create a lib folder.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;</span><span class="support function builtin shell"><span>cd</span></span><span>&nbsp;tasks</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;mkdir&nbsp;lib</span></span></div></pre>
<p>The lib folder will contain all of the modules of library code that perform the actual task operations.  The tasks folder is for wiring up the code modules in the lib folder to the named Grunt tasks.  Change to the <strong>lib</strong> folder, create a new file named <strong>mylib.js</strong>, then add the following code to the file.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>module</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>exports</span></span><span>&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>use&nbsp;strict</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function json js"><span class="entity name function js"><span>log</span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>prefix</span></span><span class="meta object delimiter js"><span>,</span></span><span>&nbsp;</span><span class="variable parameter function js"><span>message</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name type object js console"><span>console</span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js console"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span>prefix&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>=&gt;&nbsp;</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator js"><span>+</span></span><span>&nbsp;message</span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>(</span><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>This module returns a function object that when invoked returns a custom console logger that allows each log message to prefixed with a message identifier.</p>
<p>To wire this code up to a Grunt task, change to the parent tasks folder, create a new file named <strong>mytask.js</strong>, then add the following JavaScript code to the file.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>module</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>exports</span></span><span>&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>use&nbsp;strict</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="storage type var js"><span>var</span></span><span>&nbsp;myLib&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="support function js"><span>require</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>./lib/mylib.js</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>grunt</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>registerTask</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>atask</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>A&nbsp;sample&nbsp;task</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></span></div><div class="line"><span class="source js"><span class="meta method-call js"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call js"><span class="entity name function js"><span>myLib</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="meta delimiter method period js"><span>.</span></span><span class="support function js"><span>log</span></span><span class="meta brace round js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>MyApp</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>sample&nbsp;task</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>(</span><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>This code, wires up the module in the lib folder to a named Grunt task.  The final step to creating the plugin is to create Gruntfile.js for the plugin.  Change to the root package folder, create a file named <strong>Gruntfile.js</strong>, then add the following code it.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>module</span></span><span class="meta delimiter property period js"><span>.</span></span><span class="variable other property js"><span>exports</span></span><span>&nbsp;</span><span class="keyword operator assignment js"><span>=</span></span><span>&nbsp;</span><span class="meta brace round js"><span>(</span></span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>use&nbsp;strict</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="keyword control js"><span>return</span></span><span>&nbsp;</span><span class="meta function js"><span class="storage type function js"><span>function</span></span><span class="punctuation definition parameters begin js"><span>(</span></span><span class="variable parameter function js"><span>grunt</span></span><span class="punctuation definition parameters end js"><span>)</span></span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>loadTasks</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>tasks</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;</span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span><span class="meta brace round js"><span>(</span><span>)</span><span>)</span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>The <strong>Gruntfile.js</strong> loads the named Grunt tasks from the <strong>tasks</strong> folder and makes them available to Grunt in the packages that install this plugin package.</p>
<p>To test the Grunt plugin, simply use the NPM package linking (described earlier) to link this package to the project package you are currently working on.  Then include the tasks in this Grunt plugin in the Gruntfile.js of the project package like this.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>loadNpmTasks</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>mygruntplugin</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>Then reference a task from the Grunt plugin as shown here.</p>
<pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="variable other object js"><span>grunt</span></span><span class="meta method-call js"><span class="meta delimiter method period js"><span>.</span></span><span class="entity name function js"><span>registerTask</span></span><span class="punctuation definition arguments begin js"><span>(</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>mytask</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>My&nbsp;Task</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span><span>&nbsp;</span><span class="meta brace square js"><span>[</span></span><span class="string quoted single js"><span class="punctuation definition string begin js"><span>&#39;</span></span><span>atask</span><span class="punctuation definition string end js"><span>&#39;</span></span></span><span class="meta brace square js"><span>]</span></span><span class="punctuation definition arguments end js"><span>)</span></span></span><span class="punctuation terminator statement js"><span>;</span></span></span></div></pre>
<p>Save the project package&#39;s Grunt file, and run the following from the terminal.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;grunt&nbsp;mytask</span></span></div></pre>
<p>The output will be the prefixed console log message that was coded in the Grunt plugin.</p>
<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>Running&nbsp;</span><span class="string quoted double shell"><span class="punctuation definition string begin shell"><span>&quot;</span></span><span>atask</span><span class="punctuation definition string end shell"><span>&quot;</span></span></span><span>&nbsp;task</span></span></div><div class="line"><span class="source shell"><span>MyApp=</span><span class="keyword operator redirect shell"><span>&gt;</span></span><span>&nbsp;sample&nbsp;task</span></span></div><div class="line"><span class="source shell"><span>&nbsp;</span></span></div><div class="line"><span class="source shell"><span>Done,&nbsp;without&nbsp;errors.</span></span></div></pre>
<p>Creating Grunt plugins is very simple and allows for the creation of helpful and sophisticated tasks to be shared among many projects and even publicly distributed.</p>
<p>Copyright 2016, Training 4 Developers, Inc. This work is licensed under a Creative Commons Attribution 4.0 International License.</p></body>
</html>
